<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { color: #585cf6; } /* Constant */
code span.co { color: #4c886b; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.dv { color: #0000cd; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cd; } /* Float */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { color: #687687; } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #036a07; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Raspando a Lista de Baralhos de Gwent</title>

  <meta property="description" itemprop="description" content="Gwent é um jogo de cartas que nasceu dentro do universo de The Witcher e, dada a popularidade da franquia, chegou aos smartphones. A comunidade de jogadores é bastante ativa, e existe uma lista de baralhos montados por ela que está disponível dentro do site oficial do jogo. Meu objetivo neste post será raspar esta lista e os baralhos que elas sugerem. Isto servirá para montar uma base de dados para fazermos outras análises posteriormente."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-11-16"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-11-16"/>
  <meta name="article:author" content="Nicholas Marino"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Raspando a Lista de Baralhos de Gwent"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Gwent é um jogo de cartas que nasceu dentro do universo de The Witcher e, dada a popularidade da franquia, chegou aos smartphones. A comunidade de jogadores é bastante ativa, e existe uma lista de baralhos montados por ela que está disponível dentro do site oficial do jogo. Meu objetivo neste post será raspar esta lista e os baralhos que elas sugerem. Isto servirá para montar uma base de dados para fazermos outras análises posteriormente."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Raspando a Lista de Baralhos de Gwent"/>
  <meta property="twitter:description" content="Gwent é um jogo de cartas que nasceu dentro do universo de The Witcher e, dada a popularidade da franquia, chegou aos smartphones. A comunidade de jogadores é bastante ativa, e existe uma lista de baralhos montados por ela que está disponível dentro do site oficial do jogo. Meu objetivo neste post será raspar esta lista e os baralhos que elas sugerem. Isto servirá para montar uma base de dados para fazermos outras análises posteriormente."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output","draft"]}},"value":[{"type":"character","attributes":{},"value":["Raspando a Lista de Baralhos de Gwent"]},{"type":"character","attributes":{},"value":["Gwent é um jogo de cartas que nasceu dentro do universo de The Witcher e, dada a popularidade da franquia, chegou aos smartphones. A comunidade de jogadores é bastante ativa, e existe uma lista de baralhos montados por ela que está disponível dentro do site oficial do jogo. Meu objetivo neste post será raspar esta lista e os baralhos que elas sugerem. Isto servirá para montar uma base de dados para fazermos outras análises posteriormente.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["first_name","last_name","url"]}},"value":[{"type":"character","attributes":{},"value":["Nicholas"]},{"type":"character","attributes":{},"value":["Marino"]},{"type":"character","attributes":{},"value":["https://github.com/nacmarino"]}]}]},{"type":"character","attributes":{},"value":["11-16-2021"]},{"type":"character","attributes":{},"value":["web scraping","boardgames"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","code_folding","highlight"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["rstudio"]}]}]},{"type":"logical","attributes":{},"value":[true]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["gwent_decks/deck_280934.html","gwent_files/anchor-4.2.2/anchor.min.js","gwent_files/bowser-1.9.3/bowser.min.js","gwent_files/distill-2.2.21/template.v2.js","gwent_files/header-attrs-2.10/header-attrs.js","gwent_files/jquery-1.11.3/jquery.min.js","gwent_files/popper-2.6.0/popper.min.js","gwent_files/tippy-6.2.7/tippy-bundle.umd.min.js","gwent_files/tippy-6.2.7/tippy-light-border.css","gwent_files/tippy-6.2.7/tippy.css","gwent_files/tippy-6.2.7/tippy.umd.min.js","gwent_files/webcomponents-2.0.0/webcomponents.js","images/imagem_1.jpg","images/imagem_2.jpg","images/imagem_3.jpg","images/imagem_4.jpg","scripts/raspa_gwent.R"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="gwent_files/header-attrs-2.10/header-attrs.js"></script>
  <link href="gwent_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
  <script src="gwent_files/pagedtable-1.1/js/pagedtable.js"></script>
  <script src="gwent_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="gwent_files/popper-2.6.0/popper.min.js"></script>
  <link href="gwent_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="gwent_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="gwent_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="gwent_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="gwent_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="gwent_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="gwent_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Raspando a Lista de Baralhos de Gwent","description":"Gwent é um jogo de cartas que nasceu dentro do universo de The Witcher e, dada a popularidade da franquia, chegou aos smartphones. A comunidade de jogadores é bastante ativa, e existe uma lista de baralhos montados por ela que está disponível dentro do site oficial do jogo. Meu objetivo neste post será raspar esta lista e os baralhos que elas sugerem. Isto servirá para montar uma base de dados para fazermos outras análises posteriormente.","authors":[{"author":"Nicholas Marino","authorURL":"https://github.com/nacmarino","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-11-16T00:00:00.000+00:00","citationText":"Marino, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Raspando a Lista de Baralhos de Gwent</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">web scraping</div>
<div class="dt=tag">boardgames</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Gwent é um jogo de cartas que nasceu dentro do universo de The Witcher e, dada a popularidade da franquia, chegou aos smartphones. A comunidade de jogadores é bastante ativa, e existe uma lista de baralhos montados por ela que está disponível dentro do site oficial do jogo. Meu objetivo neste post será raspar esta lista e os baralhos que elas sugerem. Isto servirá para montar uma base de dados para fazermos outras análises posteriormente.</p></p>
</div>

<div class="d-byline">
  
  true
  
<br/>11-16-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#motivação">Motivação</a></li>
<li><a href="#raspando-um-deck">Raspando um deck</a></li>
<li><a href="#raspando-a-lista-de-decks">Raspando a lista de decks</a></li>
<li><a href="#qual-a-tendência-do-momento">Qual a tendência do momento?</a></li>
<li><a href="#conclusões">Conclusões</a></li>
<li><a href="#possíveis-extensões">Possíveis Extensões</a></li>
</ul>
</nav>
</div>
<h1 id="motivação">Motivação</h1>
<p>The Witcher é uma franquia lançada como uma série de livros de fantasia que contam as aventuras do bruxo (<em>i.e.</em>, Witcher) Geralt de Rivia. Essas estórias foram popularizadas através da série da Netflix de mesmo nome e, também, através do jogo para <em>videogames</em> The Witcher 3: The Wild Hunt<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Esse jogo é bastante complexo e tem uma experiência bastante imersiva, trazendo inclusive diversas tradições do universo à ela. Uma delas é o Gwent, um jogo de cartas entre dois jogadores, onde ganha aquele que mais pontuar em pelo menos 2 de 3 turnos. Parece ser um mini-jogo bobo dentro do título, mas ele próprio invoca muito da fantasia da série na disputa.</p>
<p>Gwent é um jogo que lembra muito o Magic, onde você deve construir um baralho de no mínimo 25 cartas pertencentes à uma facção de sua escolha, respeitando algumas restrições (<em>e.g.</em>, custo total das cartas no baralho, quantidade de unidades,…). No momento em que escrevo este <em>post</em>, existem cerca de 200 cartas pertencentes à cada uma de 6 facções distintas, além de outras 200 à 400 cartas neutras (<em>i.e.</em>, que não pertencem à nenhuma facção) que podem ser usadas para montar um baralho. Existe uma diferença inerente ao modo de jogar com cada facção (<em>e.g.</em>, foco em dano direto, foco bloqueio e roubo de cartas,…) e, dentro de uma dada facção, também existe uma pequena diversidade de formas de montar o baralho de forma a fortificar uma estratégia (<em>e.g.</em>, cartas que juntas reforçam muito umas as outras, cartas que ajudam a ativar a habilidade de outras cartas mais frequentemente). Neste sentido, montar um baralho forte e consistente passa a ser quase uma arte, mas que poderia ser aprimorado com um pouquinho mais de orientação baseada em dados.</p>
<p>Existe bastante conteúdo na internet que é produzido pela própria comunidade que joga o Gwent. Em particular, a própria comunidade contribui compartilhando a composição de cartas nos seus baralhos, as estratégias de jogo e votando nestas a partir do próprio site oficial do jogo. E é aqui que entra o meu interesse, pois se pudermos obter estas informações e estruturá-las, ficaria muito mais fácil entender os padrões dentro e entre os baralhos e usar isso em favor de aprimorar a jogabilidade. Além disso, acredito que estes dados podem dar um bom modelo de estudo para responder à algumas perguntas e praticar algumas outras técnicas. Falarei sobre essas idéias ao final do <em>post</em>, mas por agora vou mostrar como obter essas informações.</p>
<h1 id="raspando-um-deck">Raspando um deck</h1>
<p>A página principal dos decks disponíveis no site oficial do jogo pode ser acessada através da <em>url</em> <a href="https://www.playgwent.com/pt-BR/decks" class="uri">https://www.playgwent.com/pt-BR/decks</a>, ou clicando nesse <a href="https://www.playgwent.com/pt-BR/decks">link</a>. Assim que a página abrir, já é possível ver que os decks estão organizados em uma espécie de tabela, com diversas informações sobre eles, tais como a quantidade de votos, nome, autor, custo de fabricação e etc. Além disso, existem diversos filtros e opções de interatividade na página, como os filtros de facção, habilidade do líder, melhores baralhos e etc. Vamos voltar à essa <em>landing page</em> em breve mas, por enquanto, vamos selecionar um baralho qualquer e clicar em seu nome para ir até a sua página.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>'images/imagem_1.jpg'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="images/imagem_1.jpg" width="1678" style="display: block; margin: auto;" /></p>
</div>
<p>Chegamos à página do deck, cuja <em>url</em> parece sugerir que a paginação de cada um deles deve seguir o padrão de uma <em>url</em> base (<em>i.e.</em>, <a href="https://www.playgwent.com/pt-BR/decks/guides/" class="uri">https://www.playgwent.com/pt-BR/decks/guides/</a>) seguida de uma numeração que representa o identificador único do deck. Outra coisa que já é notável é que muitas das informações que estavam disponíveis na página anterior também estão repetidas aqui. No entanto, podemos ver que agora existe (em alguns casos) uma descrição do deck, a estratégia de uso do deck e, o mais importante, uma lista das cartas que o compõem. É esta lista que queremos pegar.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>'images/imagem_3.jpg'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="images/imagem_3.jpg" width="1678" style="display: block; margin: auto;" /></p>
</div>
<p>Se passarmos o cursor em cima das cartas, podemos ver que vai aparecer um <em>tooltip</em> com a imagem da carta e a descrição dela. Isto parece sugerir que deve existir algum tipo de linguagem dinâmica atuando por trás dos panos, o que poderia complicar a vida do nosso <em>scrapper</em>. Mas o que será que está alimentando esse conteúdo dinâmico dentro da página? Se formos na ferramenta <code>Inspecionar</code> do navegador e olharmos o próprio código HTML da página, veremos que existe uma quantidade enorme de texto dentro de uma <em>tag</em>, organizada de uma forma que lembra muito um dicionário no Python ou um arquivo JSON. Para achar esse texto, basta procurar uma <em>tag</em> <em>div</em> da classe <code>wrapper</code>, buscar dentro dela uma outra <em>tag</em> <em>div</em> da classe <code>content</code> e, mais uma vez, uma <em>tag</em> <em>div</em> com o id <code>root</code>; a partir daí, todo o dicionário pode ser acessado olhando o atributo <code>data-state</code>. Ou seja, não é que o conteúdo da página seja dinâmica, só a forma como ele é mostrado mesmo.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>'images/imagem_4.jpg'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="images/imagem_4.jpg" width="1678" style="display: block; margin: auto;" /></p>
</div>
<p>Com esse entendimento, vamos então começar a atividade de raspar esse deck. Vou criar uma função que ficará responsável por fazer um <code>GET</code> da página do deck, uma vez que o seu código numérico de identificação seja passado. Essa função também salvará essa página HTML em um algum <em>path</em> especificado e, antes de concluir, vai hibernar por 1 ou 2 segundos<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## carregando os pacotes</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span> <span class='co'># core</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://httr.r-lib.org/'>httr</a></span><span class='op'>)</span> <span class='co'># para fazer o web scrapping</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://xml2.r-lib.org/'>xml2</a></span><span class='op'>)</span> <span class='co'># para ajudar a parsear</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://fs.r-lib.org'>fs</a></span><span class='op'>)</span> <span class='co'># para manipular os paths</span>

<span class='co'>## para raspar um deck</span>
<span class='va'>scrape_deck</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>deck_id</span>, <span class='va'>path_to_save</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'>## fazendo o request e salvando em disco</span>
  <span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span>
    url <span class='op'>=</span> <span class='fu'>str_glue</span><span class='op'>(</span><span class='st'>'https://www.playgwent.com/pt-BR/decks/guides/{deck_id}'</span><span class='op'>)</span>, 
    <span class='fu'><a href='https://httr.r-lib.org/reference/write_disk.html'>write_disk</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span>fmt <span class='op'>=</span> <span class='st'>'%s/deck_%06d.html'</span>, <span class='va'>path_to_save</span>, <span class='va'>deck_id</span><span class='op'>)</span>, overwrite <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/Sys.sleep.html'>Sys.sleep</a></span><span class='op'>(</span>time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1</span>, min <span class='op'>=</span> <span class='fl'>1</span>, max <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Vamos usar agora essa função para baixar o deck da tela e salvá-lo em disco.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># setando o path local para salvar o HTML do deck</span>
<span class='va'>path_decks</span> <span class='op'>&lt;-</span> <span class='st'>'gwent_decks/'</span>
<span class='co'># path_decks &lt;- '_posts/2021-11-16-raspando-a-lista-de-baralhos-de-gwent/gwent_decks/'</span>

<span class='co'># criando um diretorio local para salvar o HTML do deck caso nao exista</span>
<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='http://fs.r-lib.org/reference/file_access.html'>dir_exists</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_decks</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='http://fs.r-lib.org/reference/create.html'>dir_create</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_decks</span>, recurse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># baixando um deck usando a funcao criada</span>
<span class='fu'>scrape_deck</span><span class='op'>(</span>deck_id <span class='op'>=</span> <span class='fl'>280934</span>, path_to_save <span class='op'>=</span> <span class='va'>path_decks</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Deck baixado! Vamos agora criar uma função para fazer uma primeira etapa do parser dele, onde a ideia vai ser tirar o dicionário que se parece com o JSON de dentro do código HTML e deixá-lo mais próximo de ser usado para pegar a lista de cartas. A função receberá como input o path até o deck salvo em disco, buscará o JSON e fará uma organização dos dados para extrair apenas a chave relacionada às informações das cartas do deck.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># para parsear o html do deck para o json</span>
<span class='va'>deck_to_json</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>path_para_deck</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># lendo o arquivo salvo como html</span>
  <span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>path_para_deck</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># pegando o xpath onde está o dicionario json</span>
    <span class='fu'><a href='http://xml2.r-lib.org/reference/xml_find_all.html'>xml_find_all</a></span><span class='op'>(</span>xpath <span class='op'>=</span> <span class='st'>'//div[@class="wrapper"]//div[@class="content"]//div[@id="root"]'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># pegando o atributo do dicionario</span>
    <span class='fu'><a href='http://xml2.r-lib.org/reference/xml_attr.html'>xml_attr</a></span><span class='op'>(</span>attr <span class='op'>=</span> <span class='st'>'data-state'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># parseando o json</span>
    <span class='fu'>jsonlite</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/jsonlite/man/fromJSON.html'>fromJSON</a></span><span class='op'>(</span>simplifyDataFrame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># pegando o guide</span>
    <span class='fu'>pluck</span><span class='op'>(</span><span class='st'>'guide'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># passando tudo para um dataframe</span>
    <span class='va'>enframe</span> <span class='op'>%&gt;%</span> 
    <span class='co'># pegando so o deck</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>name</span> <span class='op'>==</span> <span class='st'>'deck'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># desaninhando a list column</span>
    <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># pegando os valores</span>
    <span class='fu'>pull</span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Se testarmos a função para parsear o JSON do deck, veremos que o seu output é uma lista, e que cada elemento dessa lista é uma informação diferente sobre o deck - não só a lista de cartas em si. Ou seja, precisamos agora parsear e organizar as informações da lista.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># parseando o codigo de HTML para algo parecido com um JSON</span>
<span class='va'>jsonfied_deck</span> <span class='op'>&lt;-</span> <span class='fu'>deck_to_json</span><span class='op'>(</span>path_para_deck <span class='op'>=</span> <span class='fu'><a href='http://fs.r-lib.org/reference/dir_ls.html'>dir_ls</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_decks</span>, recurse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>'Classe do objeto parseado: %s. Quantidade de elementos na lista: %s.'</span>, <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>jsonfied_deck</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>jsonfied_deck</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Classe do objeto parseado: list. Quantidade de elementos na lista: 14.&quot;</code></pre>
</div>
<p>Uma coisa importante antes de prosseguir é entender um pouco sobre a estrutura básica de um deck de Gwent e a forma como ele é apresentado originalmente na página:</p>
<ul>
<li>O banner no topo do deck representa a habilidade do líder que deve ser usada. Cada facção oferece umas 6 habilidades diferentes, mas específicas para cada uma delas;<br />
</li>
<li>A carta logo abaixo do banner representa a carta de estratégia que deve ser usada junto ao deck. Existem algumas cartas de estratégia disponíveis, algumas das quais são específicas para certas facções, outras neutras. De uma forma ou de outra, todo deck tem também a sua carta de estratégia;<br />
</li>
<li>Tudo o que vier depois destes dois, representam as cartas que compõem o deck <em>per se</em>. Um deck é montado usando no mínimo 25 cartas, com mais algumas regrinhas relacionadas ao custo das cartas e quantidade de cartas de um tipo específico. Além disso, podem haver cópias de algumas cartas no deck, que são representadas pela tag <code>x2</code> ao lado de cada carta.</li>
</ul>
<p>Tendo essa visão em mente, precisamos então das informações das cartas do deck, da carta de estratégia e da habilidade do líder a fim de que possamos reproduzir o deck que está na página. Se voltarmos à lista obtida depois que parseamos o deck para algo parecido com um JSON, podemos ver que existem três elementos distintos, cada um deles para um desses tipos de informação: <code>cards</code> (<em>i.e.</em>, lista de cartas no deck), <code>stratagem</code> (<em>i.e.</em>, carta de estratégia) e <code>leader</code> (<em>i.e.</em>, a habilidade do líder). Além disso, existe uma informação importante para cada um destes itens e para cada carta em <code>cards</code> que precisaremos estar atentos: as informações do texto de descrição da carta que aparece no <code>tooltip</code>. Esse <code>tooltip</code> é uma lista de listas (de listas, em alguns casos), e tratá-lo junto dos demais metadados seria bastante doloroso. Neste contexto, vamos parsear as informações que estão no <code>tooltip</code> separado daquelas dos metadados de de cada elemento, e os juntaremos posteriormente.</p>
<p>A função abaixo dá conta de fazer o parser dos metadados associados à cada elemento. Nos testes que fiz, reparei que a forma como os metadados do elemento <code>cards</code> está organizado é diferente daquele dos outros dois elementos, <code>stratagem</code> e <code>leader</code>, mas que a estrutura destes dois é bastante similar. Assim, juntei esse parser em uma função só, usando um <code>if</code> para dizer se o processamento deve ser específico a um grupo ou outro de elementos. Além disso, aproveitei para numerar as cartas na sequência em que elas aparecem: habilidade do líder (<em>i.e.</em>, ID numérico -1), carta de estratégia (<em>i.e.</em>, ID numérico 0) e todas as demais cartas (<em>i.e.</em>, ID numérico 1 ao número de cartas no deck).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># para parsear os metadados de cada carta</span>
<span class='va'>parser_card_metadata</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>deck_json_file</span>, <span class='va'>card_type</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'cards'</span>, <span class='st'>'stratagem'</span>, <span class='st'>'leader'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># pegando os metadados da carta</span>
  <span class='va'>card_metadata</span> <span class='op'>&lt;-</span> <span class='va'>deck_json_file</span> <span class='op'>%&gt;%</span> 
    <span class='co'># selecionando o tipo de carta</span>
    <span class='fu'>pluck</span><span class='op'>(</span><span class='va'>card_type</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># descartando informacoes que nao precisamos</span>
    <span class='fu'>discard</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slotImg'</span>, <span class='st'>'slotImgCn'</span>, <span class='st'>'previewImg'</span>, <span class='st'>'previewImgCn'</span>, 
                            <span class='st'>'thumbnailImg'</span>, <span class='st'>'thumbnailImgCn'</span>, <span class='st'>'abilityImg'</span>, 
                            <span class='st'>'abilityImgCn'</span>, <span class='st'>'tooltip'</span><span class='op'>)</span><span class='op'>)</span> 
  <span class='co'># parseando cards</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>card_type</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'cards'</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>card_metadata</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>unpack</span><span class='op'>(</span>cols <span class='op'>=</span> <span class='va'>faction</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>add_column</span><span class='op'>(</span>card_in_seq <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span>, .before <span class='op'>=</span> <span class='st'>'craftingCost'</span><span class='op'>)</span>
  <span class='co'># parseando cartas de estrategia ou habilidade do lider</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>card_metadata</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>bind_cols</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='https://rdrr.io/r/base/warning.html'>suppressWarnings</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>mutate</span><span class='op'>(</span>card_in_seq <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>card_type</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'leader'</span><span class='op'>)</span> <span class='op'>{</span><span class='op'>-</span><span class='fl'>1L</span><span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span><span class='fl'>0L</span><span class='op'>}</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>card_in_seq</span>, .before <span class='op'>=</span> <span class='va'>craftingCost</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Falar do parser do tooltip.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># para fazer o parser do tooltip de cada carta</span>
<span class='va'>parser_card_tooltip</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>deck_json_file</span>, <span class='va'>card_type</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'cards'</span>, <span class='st'>'stratagem'</span>, <span class='st'>'leader'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='co'># procedimento para pegar os dados do tooltip para a carta de habilidade lider</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>card_type</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'leader'</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='co'># pegando o tooltip da habilidade do lider e juntando tudo em um tibble so</span>
    <span class='va'>tooltip_data</span> <span class='op'>&lt;-</span> <span class='va'>deck_json_file</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>pluck</span><span class='op'>(</span><span class='st'>'leader'</span>, <span class='st'>'tooltip'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>map</span><span class='op'>(</span>.f <span class='op'>=</span> <span class='va'>bind_rows</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>bind_rows</span><span class='op'>(</span><span class='op'>)</span> 
    <span class='co'># procedimento para pegar os dados do tooltip para as cartas normais ou de estrategia</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>tooltip_data</span> <span class='op'>&lt;-</span> <span class='va'>deck_json_file</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>pluck</span><span class='op'>(</span><span class='va'>card_type</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='st'>'tooltip'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>map</span><span class='op'>(</span>.f <span class='op'>=</span> <span class='va'>bind_rows</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>enframe</span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>'card_in_seq'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>unnest</span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>card_in_seq</span><span class='op'>)</span> 
  <span class='op'>}</span>
  
  <span class='co'># summarizando os dados de cada tooltip para cada carta</span>
  <span class='va'>tooltip_data</span> <span class='op'>&lt;-</span> <span class='va'>tooltip_data</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>summarise</span><span class='op'>(</span>
      keywords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'>str_to_lower</span><span class='op'>(</span>string <span class='op'>=</span> <span class='va'>key</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>key</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>, collapse <span class='op'>=</span> <span class='st'>';'</span><span class='op'>)</span>,
      texto    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>value</span>, collapse <span class='op'>=</span> <span class='st'>' '</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># tratando o texto do tooltip</span>
    <span class='fu'>mutate</span><span class='op'>(</span>
      keywords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span>test <span class='op'>=</span> <span class='va'>keywords</span> <span class='op'>==</span> <span class='st'>''</span>, yes <span class='op'>=</span> <span class='cn'>NA</span>, no <span class='op'>=</span> <span class='va'>keywords</span><span class='op'>)</span>,
      keywords <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span>string <span class='op'>=</span> <span class='va'>keywords</span><span class='op'>)</span>,
      texto <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span>string <span class='op'>=</span> <span class='va'>texto</span>, pattern <span class='op'>=</span> <span class='st'>'\\s+'</span>, replacement <span class='op'>=</span> <span class='st'>' '</span><span class='op'>)</span>,
      texto <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span>string <span class='op'>=</span> <span class='va'>texto</span>, pattern <span class='op'>=</span> <span class='st'>'\\s:'</span>, replacement <span class='op'>=</span> <span class='st'>':'</span><span class='op'>)</span>,
      texto <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span>string <span class='op'>=</span> <span class='va'>texto</span>, pattern <span class='op'>=</span> <span class='st'>'(?&lt;=\\()\\s|\\s(?=\\))'</span>, replacement <span class='op'>=</span> <span class='st'>''</span><span class='op'>)</span>,
      texto <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span>string <span class='op'>=</span> <span class='va'>texto</span>, pattern <span class='op'>=</span> <span class='st'>'\\s(?=\\.)|\\s(?=\\,)'</span>, replacement <span class='op'>=</span> <span class='st'>''</span><span class='op'>)</span>,
    <span class='op'>)</span>
  
  <span class='co'># adicionando identificador numerico para a carta do tooltip e retornando o resultado</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>card_type</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'cards'</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>tooltip_data</span>
  <span class='op'>}</span>
  <span class='kw'>else</span><span class='op'>{</span>
    <span class='fu'>mutate</span><span class='op'>(</span><span class='va'>tooltip_data</span>,
           card_in_seq <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>card_type</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'leader'</span><span class='op'>)</span> <span class='op'>{</span><span class='op'>-</span><span class='fl'>1L</span><span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span><span class='fl'>0L</span><span class='op'>}</span>
    <span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>card_in_seq</span>, .before <span class='op'>=</span> <span class='va'>keywords</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Testar o parser consolidando em uma unica funcao.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># para parsear todas as informacoes do deck</span>
<span class='va'>parser_cards</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>path_para_deck</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># parseando o json do deck</span>
  <span class='va'>target_deck</span> <span class='op'>&lt;-</span> <span class='fu'>deck_to_json</span><span class='op'>(</span>path_para_deck <span class='op'>=</span> <span class='va'>path_para_deck</span><span class='op'>)</span>
  
  <span class='co'># pegando os tooltips de todas as cartas</span>
  <span class='va'>tooltips</span> <span class='op'>&lt;-</span> <span class='fu'>map_dfr</span><span class='op'>(</span>.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'leader'</span>, <span class='st'>'stratagem'</span>, <span class='st'>'cards'</span><span class='op'>)</span>,
                      .f <span class='op'>=</span> <span class='va'>parser_card_tooltip</span>,
                      deck_json_file <span class='op'>=</span> <span class='va'>target_deck</span><span class='op'>)</span>
  
  <span class='co'># pegando os metadados de todas as cartas</span>
  <span class='va'>metadados</span> <span class='op'>&lt;-</span> <span class='fu'>map_dfr</span><span class='op'>(</span>.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'leader'</span>, <span class='st'>'stratagem'</span>, <span class='st'>'cards'</span><span class='op'>)</span>,
                       .f <span class='op'>=</span> <span class='va'>parser_card_metadata</span>,
                       deck_json_file <span class='op'>=</span> <span class='va'>target_deck</span><span class='op'>)</span>
  
  <span class='fu'>left_join</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>metadados</span>, y <span class='op'>=</span> <span class='va'>tooltips</span>, by <span class='op'>=</span> <span class='st'>'card_in_seq'</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Vamos testar o parser do deck.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># parseando o deck</span>
<span class='va'>parsed_deck</span> <span class='op'>&lt;-</span> <span class='fu'>parser_cards</span><span class='op'>(</span>path_para_deck <span class='op'>=</span> <span class='fu'><a href='http://fs.r-lib.org/reference/dir_ls.html'>dir_ls</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_decks</span>, recurse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># visualizando a tabela do deck</span>
<span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'>parser_cards</span><span class='op'>(</span>path_para_deck <span class='op'>=</span> <span class='fu'><a href='http://fs.r-lib.org/reference/dir_ls.html'>dir_ls</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_decks</span>, recurse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["card_in_seq"],"name":[1],"type":["int"],"align":["right"]},{"label":["craftingCost"],"name":[2],"type":["int"],"align":["right"]},{"label":["localizedName"],"name":[3],"type":["chr"],"align":["left"]},{"label":["fluff"],"name":[4],"type":["chr"],"align":["left"]},{"label":["rarity"],"name":[5],"type":["chr"],"align":["left"]},{"label":["repeatCount"],"name":[6],"type":["int"],"align":["right"]},{"label":["ownable"],"name":[7],"type":["lgl"],"align":["right"]},{"label":["id"],"name":[8],"type":["int"],"align":["right"]},{"label":["name"],"name":[9],"type":["chr"],"align":["left"]},{"label":["short"],"name":[10],"type":["chr"],"align":["left"]},{"label":["slug"],"name":[11],"type":["chr"],"align":["left"]},{"label":["cardGroup"],"name":[12],"type":["chr"],"align":["left"]},{"label":["power"],"name":[13],"type":["int"],"align":["right"]},{"label":["provisionsCost"],"name":[14],"type":["int"],"align":["right"]},{"label":["type"],"name":[15],"type":["chr"],"align":["left"]},{"label":["armour"],"name":[16],"type":["int"],"align":["right"]},{"label":["categoryName"],"name":[17],"type":["chr"],"align":["left"]},{"label":["primaryCategoryId"],"name":[18],"type":["int"],"align":["right"]},{"label":["categoryIds"],"name":[19],"type":["list"],"align":["right"]},{"label":["secondaryFactions"],"name":[20],"type":["list"],"align":["right"]},{"label":["keywords"],"name":[21],"type":["chr"],"align":["left"]},{"label":["texto"],"name":[22],"type":["chr"],"align":["left"]}],"data":[{"1":"-1","2":"0","3":"Postura de Batalha","4":"Ninguém substituirá o Bran. Mas sabemos que eles tentarão.","5":"legendary","6":"0","7":"TRUE","8":"200159","9":"Battle Trance","10":"ske","11":"skellige","12":"leader","13":"0","14":"16","15":"leader","16":"0","17":"NA","18":"NA","19":"<NULL>","20":"<NULL>","21":"order;spawn;heal","22":"Ordem: faz surgir e usa Mardroeme. Sempre que você usa uma carta de alquimia, cura uma unidade aliada aleatória em 1. Esta habilidade adiciona 16 de recrutamento ao limite de recrutamento do seu baralho."},{"1":"0","2":"800","3":"Máscara de Uroboros","4":"O tempo não flui — corre em círculos. O passado se torna o futuro, os avôs repetem os erros dos netos.","5":"legendary","6":"0","7":"TRUE","8":"202512","9":"Mask of Uroboros","10":"ske","11":"skellige","12":"gold","13":"0","14":"0","15":"stratagem","16":"0","17":"NA","18":"NA","19":"<NULL>","20":"<NULL>","21":"order;discard;spawn;melee","22":"Ordem: compra uma carta e, em seguida, descarta uma carta e faz surgir 2 Corvos na sua fileira Corpo a corpo."},{"1":"1","2":"200","3":"Morkvarg","4":"O homem mais vil que Skellige já conheceu.","5":"epic","6":"0","7":"TRUE","8":"152209","9":"Morkvarg","10":"ske","11":"skellige","12":"gold","13":"5","14":"7","15":"unit","16":"0","17":"Fera, Amaldiçoado, Pirata","18":"12","19":"<int [2]>","20":"<list [0]>","21":"summon;melee;doomed","22":"Se esta unidade for para a pilha de descarte durante a rodada, ela é invocada para a sua fileira corpo a corpo e ganha Condenado."},{"1":"2","2":"800","3":"Birna Bran","4":"Skellige precisa de um rei forte. Custe o que custar.","5":"legendary","6":"0","7":"TRUE","8":"152105","9":"Birna Bran","10":"ske","11":"skellige","12":"gold","13":"6","14":"8","15":"unit","16":"0","17":"Humano","18":"78","19":"<int [0]>","20":"<list [0]>","21":"deploy;discard","22":"Mobilização: compra até 2 cartas e, em seguida, descarta o mesmo número de cartas."},{"1":"3","2":"200","3":"Elixir de Gigaescorpião","4":"Que dose seria necessária para ser fatal? Qualquer uma.","5":"epic","6":"0","7":"TRUE","8":"202515","9":"Gigascorpion Decoction","10":"ske","11":"skellige","12":"gold","13":"0","14":"6","15":"special","16":"0","17":"Alquimia","18":"33","19":"<int [0]>","20":"<list [0]>","21":"NA","22":"Causa 1 de dano a uma unidade seis vezes."},{"1":"4","2":"200","3":"Derran","4":"Seja lá o que tenha causado esta loucura, deve ser aterrorizante...","5":"epic","6":"0","7":"TRUE","8":"201646","9":"Derran","10":"ske","11":"skellige","12":"gold","13":"8","14":"6","15":"unit","16":"0","17":"Humano","18":"78","19":"<int [0]>","20":"<list [0]>","21":"deploy;ranged","22":"Mobilização (Longa distância): causa 3 de dano a si e, em seguida, move uma carta do seu baralho para a sua pilha de descarte."},{"1":"5","2":"30","3":"Andorinha","4":"Simbolizando nascimento e rejuvenescimento, esta poção acelera a velocidade na qual as feridas cicatrizam e curam.","5":"common","6":"1","7":"TRUE","8":"113310","9":"Swallow","10":"neu","11":"neutral","12":"bronze","13":"0","14":"4","15":"special","16":"0","17":"Alquimia","18":"33","19":"<int [0]>","20":"<list [0]>","21":"NA","22":"Reforça uma unidade em 6."},{"1":"6","2":"30","3":"Tuirseach: Combatente","4":"Aos amigos mostramos o coração. Aos inimigos o machado. Lembre-se.","5":"common","6":"1","7":"TRUE","8":"152313","9":"Tuirseach Skirmisher","10":"ske","11":"skellige","12":"bronze","13":"4","14":"4","15":"unit","16":"0","17":"Humano, Guerreiro","18":"78","19":"<int [1]>","20":"<list [0]>","21":"discard;summon;melee","22":"Quando esta unidade é descartada, é invocada da sua pilha de descarte para a sua fileira corpo a corpo."},{"1":"7","2":"30","3":"Heymaey: Escaldo","4":"Os feitos do clã Heymaey entrarão para a história.","5":"common","6":"0","7":"TRUE","8":"152308","9":"Heymaey Skald","10":"ske","11":"skellige","12":"bronze","13":"4","14":"4","15":"unit","16":"0","17":"Humano","18":"78","19":"<int [0]>","20":"<list [0]>","21":"deploy;ranged;discard","22":"Mobilização (Longa distância): compra uma carta e, em seguida, descarta uma carta."},{"1":"8","2":"800","3":"O Teste das Ervas","4":"Imaginem um pedaço de argila. Para dar forma, é preciso umedecê-la, se não ela se despedaça. A primeira parte do Teste faz isso. Ela abre o corpo para a mudança, por assim dizer. Só então as poções mutagênicas produzirão um bruxo.","5":"legendary","6":"0","7":"TRUE","8":"200078","9":"Trial of the Grasses","10":"neu","11":"neutral","12":"gold","13":"0","14":"6","15":"special","16":"0","17":"Alquimia","18":"33","19":"<int [0]>","20":"<list [0]>","21":"NA","22":"Define o poder de uma unidade para 12. Se não for um Bruxo, causa 6 de dano a ela primeiro."},{"1":"9","2":"200","3":"Maxii Van Dekkar","4":"Magia não funciona nela, pois é uma filha orgulhosa do Sol Negro — e uma caçadora de recompensas de olho em alguns feiticeiros muito poderosos.","5":"epic","6":"0","7":"TRUE","8":"202786","9":"Maxii Van Dekkar","10":"neu","11":"neutral","12":"gold","13":"6","14":"5","15":"unit","16":"0","17":"Humano","18":"78","19":"<int [0]>","20":"<list [0]>","21":"deploy","22":"Mobilização: olhe o seu baralho começando por cima. Você pode embaralhar as cartas e colocar uma carta no final do baralho."},{"1":"10","2":"800","3":"Gedyneith","4":"Governantes são coroados sob sua sombra. Traidores são pendurados em seus galhos.","5":"legendary","6":"0","7":"TRUE","8":"202513","9":"Gedyneith","10":"ske","11":"skellige","12":"gold","13":"0","14":"13","15":"artifact","16":"0","17":"Cenário","18":"107","19":"<int [0]>","20":"<list [0]>","21":"doomed;spawn","22":"Condenado. Cenário: avança sempre que você usa um druida. Prólogo: faz surgir um Pregador do Clã dos Corvos nesta fileira. Capítulo 1: faz surgir e usa Rizoma de Olho de Corvo. Capítulo 2: faz surgir e usa Mardroeme."},{"1":"11","2":"80","3":"Clã Corvo: Pregador","4":"Muitos aprendizados lhe aguardam. E muitos erros.","5":"rare","6":"1","7":"TRUE","8":"202518","9":"Crow Clan Preacher","10":"ske","11":"skellige","12":"bronze","13":"4","14":"4","15":"unit","16":"0","17":"Humano, Druida","18":"78","19":"<int [1]>","20":"<list [0]>","21":"bonded","22":"Sempre que você usa uma carta de Alquimia, reforça em 1 a si. Elo: reforça em 2 a si em vez disso."},{"1":"12","2":"800","3":"Mãe dos Corvos","4":"Alguns corvos aprendem algumas palavras dos humanos. E alguns humanos aprendem o idioma dos corvos.","5":"legendary","6":"0","7":"TRUE","8":"202514","9":"Crowmother","10":"ske","11":"skellige","12":"gold","13":"4","14":"10","15":"unit","16":"0","17":"Humano, Druida","18":"78","19":"<int [1]>","20":"<list [0]>","21":"deploy;spawn;summon","22":"Mobilização: faz surgir 2 corvos nesta fileira. Sempre que você usa uma carta de Alquimia, evoca Mãe dos Corvos do seu cemitério em uma fileira aliada aleatória."},{"1":"13","2":"800","3":"Andarilhos do Crepúsculo","4":"Parerce que Dandelion queria fazer uma jornada com o bruxo — até o fim do mundo.","5":"legendary","6":"0","7":"TRUE","8":"202953","9":"Sunset Wanderers","10":"neu","11":"neutral","12":"gold","13":"1","14":"13","15":"unit","16":"0","17":"Bruxo","18":"31","19":"<int [0]>","20":"<list [0]>","21":"summon","22":"Esta carta começa no lado esquerdo da sua mão. No início do seu turno, enquanto estiver na mão, move a si uma posição para a direita e, em seguida, reforça a si em 1. No fim do seu turno, caso não tenha passado e não haja cartas à direita desta carta, invoca a si da sua mão para uma fileira aliada aleatória e, em seguida, compra uma carta."},{"1":"14","2":"800","3":"Korathi Chamardente","4":"Estudiosos de Vicovaro determinaram que, na ausência de ajuda imperial, províncias assoladas pela seca perdem metade de sua população, dois terços de seu gado e toda a vontade de se rebelar.","5":"legendary","6":"0","7":"TRUE","8":"200018","9":"Korathi Heatwave","10":"neu","11":"neutral","12":"gold","13":"0","14":"10","15":"special","16":"0","17":"NA","18":"NA","19":"<int [0]>","20":"<list [0]>","21":"banish","22":"Bane uma unidade ou artefato."},{"1":"15","2":"800","3":"Coral","4":"O nome verdadeiro dela é Astrid Lyttneyd Ásgeirrfinnbjornsdottir, mas nenhum formulário tinha espaço pra isso.","5":"legendary","6":"0","7":"TRUE","8":"152107","9":"Coral","10":"ske","11":"skellige","12":"gold","13":"6","14":"8","15":"unit","16":"0","17":"Humano, Mago","18":"78","19":"<int [1]>","20":"<list [0]>","21":"zeal;order;discard","22":"Zelo. Ordem: compra uma carta e, em seguida, descarta uma carta. Sempre que você descarta uma carta, causa 2 de dano a uma unidade inimiga aleatória."},{"1":"16","2":"80","3":"Cantarina Havfrue","4":"Nenhum humano é páreo para as sereias na hora de cantar. Alguns, no entanto, são talentosos o suficiente para obrigar as sereias a escutá-los.","5":"rare","6":"0","7":"TRUE","8":"202983","9":"Havfrue Singer","10":"ske","11":"skellige","12":"bronze","13":"4","14":"5","15":"unit","16":"0","17":"Humano, Cultista, Druida","18":"78","19":"<int [2]>","20":"<list [0]>","21":"deploy;heal;spawn","22":"Mobilização: cura uma unidade aliada em 2. A primeira vez que você cura uma unidade aliada durante o seu turno, faz surgir uma Sereia Ensurdecedora nesta fileira."},{"1":"17","2":"80","3":"Dwimveandra","4":"Existem aqueles que ficam em casa e aqueles que optam por sair.","5":"rare","6":"1","7":"TRUE","8":"203003","9":"Dwimveandra","10":"neu","11":"neutral","12":"bronze","13":"4","14":"5","15":"unit","16":"0","17":"Humano, Mago","18":"78","19":"<int [1]>","20":"<list [0]>","21":"deploy;melee;ranged;order","22":"Mobilização (Corpo a corpo): define um cenário aliado para o capítulo final. Mobilização (Longa distância): redefine a Ordem de um Local aliado."},{"1":"18","2":"800","3":"Fucusya","4":"Como as sereias, as bruxas do mar podem sentir amor verdadeiro apenas uma vez na vida. E Fucusya perdeu sua única vez com um humano.","5":"legendary","6":"0","7":"TRUE","8":"203041","9":"Fucusya","10":"ske","11":"skellige","12":"gold","13":"4","14":"13","15":"unit","16":"0","17":"Fera","18":"12","19":"<int [0]>","20":"<list [0]>","21":"deploy;doomed;spawn;rain","22":"Mobilização: usa uma unidade Skellige da sua pilha de descarte com um custo de recrutamento de 10 ou menos e concede-lhe Condenado. Faz surgir chuva na fileira oposta com uma duração igual à de recrutamentos não usados."},{"1":"19","2":"800","3":"A Trufa Carnuda","4":"Alguns bebem para comemorar. Outros, para esquecer. Mas aqui? Aqui não precisamos de motivo.","5":"legendary","6":"0","7":"TRUE","8":"203061","9":"The Mushy Truffle","10":"neu","11":"neutral","12":"gold","13":"0","14":"10","15":"artifact","16":"0","17":"Local","18":"109","19":"<int [0]>","20":"<list [0]>","21":"resilient;deploy;spawn;bonded;order","22":"Resiliência. Mobilização: faz surgir e usa uma unidade de Elo do seu baralho inicial. Ordem: faz surgir e usa Espuma Dourada."},{"1":"20","2":"30","3":"Pequena Havfrue","4":"Eles não hesitarão em encher você de presentes e carinho. Eles professarão orgulhosamente sua adoração inabalável e devoção resoluta. No entanto, eu lhe pergunto: quando um homem desistiu das próprias pernas por amor? Hein?","5":"common","6":"1","7":"TRUE","8":"203044","9":"Little Havfrue","10":"ske","11":"skellige","12":"bronze","13":"6","14":"4","15":"unit","16":"0","17":"Fera","18":"12","19":"<int [0]>","20":"<list [0]>","21":"deploy;bonded;order;spawn;rain","22":"Mobilização (Elo): aumenta em 2 o poder básico desta carta. Ordem: causa 4 de dano a si e faz surgir chuva por 2 turnos numa fileira inimiga."}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<p>Concluir que agora precisamos de mais decks. Para isso, vamos raspar a lista para pegar o id dos decks.</p>
<h1 id="raspando-a-lista-de-decks">Raspando a lista de decks</h1>
<p>Voltar para a landing page e falar que não tem paginação, que o conteúdo parece ser gerado dinamicamente.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>'images/imagem_1.jpg'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="images/imagem_1.jpg" width="1678" style="display: block; margin: auto;" /></p>
</div>
<p>Mostrar que se abrir o network, vai ver que tem uma API escondida.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>'images/imagem_2.jpg'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="images/imagem_2.jpg" width="1678" style="display: block; margin: auto;" /></p>
</div>
<p>Falar do scrapper da lista.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## para raspar uma lista</span>
<span class='va'>scrape_lista</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>pagina</span>, <span class='va'>listas_por_pagina</span>, <span class='va'>path_to_save</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'>## calculando o offset atraves da pagina que deseja-se pegar</span>
  <span class='va'>offset</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>pagina</span> <span class='op'>*</span> <span class='va'>listas_por_pagina</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>listas_por_pagina</span>
  <span class='co'>## fazendo o request e salvando em disco</span>
  <span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span>
    url <span class='op'>=</span> <span class='fu'>str_glue</span><span class='op'>(</span><span class='st'>'https://www.playgwent.com/pt-BR/decks/api/guides/offset/{offset}/limit/{listas_por_pagina}'</span><span class='op'>)</span>, 
    <span class='fu'><a href='https://httr.r-lib.org/reference/write_disk.html'>write_disk</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span>fmt <span class='op'>=</span> <span class='st'>'%s/pagina_%06d.json'</span>, <span class='va'>path_to_save</span>, <span class='va'>pagina</span><span class='op'>)</span>, overwrite <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/Sys.sleep.html'>Sys.sleep</a></span><span class='op'>(</span>time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1</span>, min <span class='op'>=</span> <span class='fl'>1e-2</span>, max <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Falar do uso escalando.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># criar diretorio e baixar umas 5 paginas da lista, aumentando o limit.</span>
</code></pre>
</div>
</div>
<p>Falar da funcao do parser da lista.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## para parseaar uma lista</span>
<span class='va'>parser_lista</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>path_para_lista</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># carregando os dados como um json</span>
  <span class='fu'>read_json</span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_para_lista</span>, simplifyDataFrame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># pegando so o elemento da lista que sejam os guides</span>
    <span class='fu'>pluck</span><span class='op'>(</span><span class='st'>'guides'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># passando para tibble</span>
    <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># desempacotando o dataframe column para multiplas colunas</span>
    <span class='fu'>unpack</span><span class='op'>(</span>cols <span class='op'>=</span> <span class='va'>faction</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># jogando fora o que nao interessa</span>
    <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>short</span>, <span class='va'>thumbnailImg</span>, <span class='va'>abilityImg</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h1 id="qual-a-tendência-do-momento">Qual a tendência do momento?</h1>
<p>Mostrar análise do tipo de deck, custo da carta, votos, datas de contribuição e modificação.</p>
<h1 id="conclusões">Conclusões</h1>
<h1 id="possíveis-extensões">Possíveis Extensões</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Um dos jogos mais <em>tops</em> que já joguei.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Esse passo não é obrigatório, mas decidi colocá-lo aqui só para não bombardear o servidor de <em>request</em> uma vez que eu vá usar essa função dentro de um <code>map</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
