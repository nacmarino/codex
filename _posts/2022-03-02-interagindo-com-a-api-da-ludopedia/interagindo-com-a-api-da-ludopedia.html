<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { color: #585cf6; } /* Constant */
code span.co { color: #4c886b; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.dv { color: #0000cd; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cd; } /* Float */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { color: #687687; } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #036a07; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Interagindo com a API da Ludopedia</title>

  <meta property="description" itemprop="description" content="Neste post eu mostro como interagir com a API da Ludopedia para adquirir os dados dos jogos de tabuleiro disponíveis nesse portal. Veremos que o processo é diferente daquele que usamos para explorar a API do BoardGameGeek, apesar das informações obtidas serem bastante similares. Este post servirá de referência para outras ideias que vamos desenvolver no futuro."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-03-06"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-03-06"/>
  <meta name="article:author" content="Nicholas Marino"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Interagindo com a API da Ludopedia"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Neste post eu mostro como interagir com a API da Ludopedia para adquirir os dados dos jogos de tabuleiro disponíveis nesse portal. Veremos que o processo é diferente daquele que usamos para explorar a API do BoardGameGeek, apesar das informações obtidas serem bastante similares. Este post servirá de referência para outras ideias que vamos desenvolver no futuro."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Interagindo com a API da Ludopedia"/>
  <meta property="twitter:description" content="Neste post eu mostro como interagir com a API da Ludopedia para adquirir os dados dos jogos de tabuleiro disponíveis nesse portal. Veremos que o processo é diferente daquele que usamos para explorar a API do BoardGameGeek, apesar das informações obtidas serem bastante similares. Este post servirá de referência para outras ideias que vamos desenvolver no futuro."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","preview","categories","output","draft"]}},"value":[{"type":"character","attributes":{},"value":["Interagindo com a API da Ludopedia"]},{"type":"character","attributes":{},"value":["Neste post eu mostro como interagir com a API da Ludopedia para adquirir os dados dos jogos de tabuleiro disponíveis nesse portal. Veremos que o processo é diferente daquele que usamos para explorar a API do BoardGameGeek, apesar das informações obtidas serem bastante similares. Este post servirá de referência para outras ideias que vamos desenvolver no futuro.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["first_name","last_name","url"]}},"value":[{"type":"character","attributes":{},"value":["Nicholas"]},{"type":"character","attributes":{},"value":["Marino"]},{"type":"character","attributes":{},"value":["https://github.com/nacmarino"]}]}]},{"type":"character","attributes":{},"value":["03-06-2022"]},{"type":"character","attributes":{},"value":["images/cartografia.png"]},{"type":"character","attributes":{},"value":["web scraping","boardgames"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","code_folding","highlight"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["rstudio"]}]}]},{"type":"logical","attributes":{},"value":[true]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["images/cria_app_passo_1.png","images/cria_app_passo_2.png","images/cria_app_passo_3.png","images/logo_ludopedia.png","interagindo-com-a-api-da-ludopedia_files/anchor-4.2.2/anchor.min.js","interagindo-com-a-api-da-ludopedia_files/bowser-1.9.3/bowser.min.js","interagindo-com-a-api-da-ludopedia_files/distill-2.2.21/template.v2.js","interagindo-com-a-api-da-ludopedia_files/figure-html5/cria_app_1-1.png","interagindo-com-a-api-da-ludopedia_files/figure-html5/cria_app_2-1.png","interagindo-com-a-api-da-ludopedia_files/figure-html5/cria_app_3-1.png","interagindo-com-a-api-da-ludopedia_files/header-attrs-2.10/header-attrs.js","interagindo-com-a-api-da-ludopedia_files/jquery-1.11.3/jquery.min.js","interagindo-com-a-api-da-ludopedia_files/pagedtable-1.1/css/pagedtable.css","interagindo-com-a-api-da-ludopedia_files/pagedtable-1.1/js/pagedtable.js","interagindo-com-a-api-da-ludopedia_files/popper-2.6.0/popper.min.js","interagindo-com-a-api-da-ludopedia_files/tippy-6.2.7/tippy-bundle.umd.min.js","interagindo-com-a-api-da-ludopedia_files/tippy-6.2.7/tippy-light-border.css","interagindo-com-a-api-da-ludopedia_files/tippy-6.2.7/tippy.css","interagindo-com-a-api-da-ludopedia_files/tippy-6.2.7/tippy.umd.min.js","interagindo-com-a-api-da-ludopedia_files/webcomponents-2.0.0/webcomponents.js","scripts/01_scrapper.R","temporario_jogos/lista_jogos_pagina_1.json","temporario_metadados/info_do_jogo_2.json"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="interagindo-com-a-api-da-ludopedia_files/header-attrs-2.10/header-attrs.js"></script>
  <link href="interagindo-com-a-api-da-ludopedia_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
  <script src="interagindo-com-a-api-da-ludopedia_files/pagedtable-1.1/js/pagedtable.js"></script>
  <script src="interagindo-com-a-api-da-ludopedia_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="interagindo-com-a-api-da-ludopedia_files/popper-2.6.0/popper.min.js"></script>
  <link href="interagindo-com-a-api-da-ludopedia_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="interagindo-com-a-api-da-ludopedia_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="interagindo-com-a-api-da-ludopedia_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="interagindo-com-a-api-da-ludopedia_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="interagindo-com-a-api-da-ludopedia_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="interagindo-com-a-api-da-ludopedia_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="interagindo-com-a-api-da-ludopedia_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Interagindo com a API da Ludopedia","description":"Neste post eu mostro como interagir com a API da Ludopedia para adquirir os dados dos jogos de tabuleiro disponíveis nesse portal. Veremos que o processo é diferente daquele que usamos para explorar a API do BoardGameGeek, apesar das informações obtidas serem bastante similares. Este post servirá de referência para outras ideias que vamos desenvolver no futuro.","authors":[{"author":"Nicholas Marino","authorURL":"https://github.com/nacmarino","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-03-06T00:00:00.000+00:00","citationText":"Marino, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Interagindo com a API da Ludopedia</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">web scraping</div>
<div class="dt=tag">boardgames</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Neste post eu mostro como interagir com a API da Ludopedia para adquirir os dados dos jogos de tabuleiro disponíveis nesse portal. Veremos que o processo é diferente daquele que usamos para explorar a API do BoardGameGeek, apesar das informações obtidas serem bastante similares. Este post servirá de referência para outras ideias que vamos desenvolver no futuro.</p></p>
</div>

<div class="d-byline">
  
  true
  
<br/>03-06-2022
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#motivação">Motivação</a></li>
<li><a href="#autenticação">Autenticação</a>
<ul>
<li><a href="#criando-o-aplicativo">Criando o Aplicativo</a></li>
<li><a href="#pegando-o-token">Pegando o Token</a></li>
</ul></li>
<li><a href="#interagindo-com-a-api">Interagindo com a API</a>
<ul>
<li><a href="#pegando-a-lista-de-jogos">Pegando a lista de jogos</a></li>
<li><a href="#pegando-as-informações-de-um-jogo">Pegando as informações de um jogo</a></li>
<li><a href="#outros-usos-da-api">Outros usos da API</a></li>
</ul></li>
<li><a href="#dicionário-de-dados">Dicionário de Dados</a></li>
<li><a href="#conclusões">Conclusões</a></li>
<li><a href="#possíveis-extensões">Possíveis Extensões</a></li>
</ul>
</nav>
</div>
<h1 id="motivação">Motivação</h1>
<p>Ao longo dos últimos posts, apresentei alguns <em>scrappers</em> e <a href="https://nacmarino.github.io/codex/posts/2021-12-11-quao-similares-sao-as-notas-dos-jogos-de-tabuleiro-entre-os-portais-especializados/">análises</a> baseadas nos dados disponíveis em dois portais de jogos de tabuleiro: o <a href="https://nacmarino.github.io/codex/posts/2021-09-17-raspando-a-pgina-do-ranking-do-boardgamegeek/">BoardGameGeek</a> e a <a href="https://nacmarino.github.io/codex/posts/2021-10-24-raspando-a-pagina-do-ranking-da-ludopedia/">Ludopedia</a>. Tudo o que foi desenvolvido focou muito nos rankings daqueles portais mas, recentemente, mostrei como podemos obter dados mais interessantes do que estes através da <a href="https://nacmarino.github.io/codex/posts/2022-01-23-interagindo-com-a-api-do-boardgamegeek/">API XML do BoardGameGeek</a>. A Ludopedia também oferece dados similares a esses, e que podem ser acessados através de uma REST API disponibilizada pelo portal. Assim, poderíamos usar essas APIs para obter o mesmo tipo de informação entre portais distintos, abrindo a possibilidade de desenvolvermos análises comparativas mais aprofundadas do que àquelas que já fizemos e explorar outras possibilidades.</p>
<p>Este post mostrará o passo a passo de como interagir com a REST API da Ludopedia. Esta é uma API que necessita de autenticação OAUTH 2.0 e, portanto, começaremos mostrando como fazer esta autenticação. Na sequência, veremos como usar os <em>endpoints</em> da API para extrair a lista de jogos e os metadados associados a eles. Com isso, espero que este post ilustre os tipos de dados que teremos à nossa disposição, além de servir de referência para a aquisição e tratamento dos dados da Ludopedia em posts futuros. Vamos ao trabalho!</p>
<h1 id="autenticação">Autenticação</h1>
<p>Como já comentamos, a Ludopedia oferece uma REST API que faz uso de autenticação OAUTH 2.0, fazendo com que tenhamos que ter um token de acesso para que possamos passar as requisições para a API. O processo de autenticação e o uso dos <em>endpoints</em> da API é bem documentada, e pode ser acessada através deste <a href="https://ludopedia.com.br/api/documentacao.html">link</a>. No geral, a obtenção do token de acesso passa por duas etapas: a primeira é a criação de um aplicativo no site da Ludopedia que ficará responsável por gerar o token de acesso, e a segunda é a requisição do mesmo. Como tive bastante dificuldade em fazer sentido do encadeamento das etapas deste processo, vou apresentá-los abaixo e mostrar como fazer essa autenticação através do R.</p>
<h2 id="criando-o-aplicativo">Criando o Aplicativo</h2>
<p>O primeiro passo para a utilização da API é a criação de um aplicativo no portal da Ludopedia, que pode ser feita por <a href="https://ludopedia.com.br/aplicativos">aqui</a>. Acredito que um pré-requisito para isso é que você tenha uma conta ativa no portal da Ludopedia, que pode ser criada gratuitamente e sem muito drama. Assumindo que você já tem essa conta, está logado no portal e tenha aberto o link acima, a página que você deve cair é àquela da figura abaixo. Para criar um aplicativo, não tem mistério: é só clicar no botão verde limão onde está escrito <strong>Novo Aplicativo</strong>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>magick</span><span class='fu'>::</span><span class='fu'><a href='https://docs.ropensci.org/magick/reference/editing.html'>image_read</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>'images/cria_app_passo_1.png'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="interagindo-com-a-api-da-ludopedia_files/figure-html5/cria_app_1-1.png" width="1470" style="display: block; margin: auto;" /></p>
</div>
<p>Assim que a página seguinte for carregada, você verá um formulário conforme aquele apresentado na figura abaixo. Apesar de existirem alguns campos que podem ser preenchidos, você só precisa focar em dois deles:</p>
<ul>
<li><strong>Nome do Aplicativo</strong>, que será o nome que você dará para este aplicativo; e,</li>
<li><strong>URI de Retorno de Autorização (Redirect URI)</strong>, que será a <em>url</em> para a qual o usuário do aplicativo será redirecionado após ter o acesso aprovado. Das coisas que pesquisei por aí, resolvi usar <code>http://localhost:1410/</code>.</li>
</ul>
<p>Depois de preencher aqueles dois campos, basta clicar no <em>checkbox</em> para concordar com o termos de uso e, então, clicar em <strong>Gravar</strong>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>magick</span><span class='fu'>::</span><span class='fu'><a href='https://docs.ropensci.org/magick/reference/editing.html'>image_read</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>'images/cria_app_passo_2.png'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="interagindo-com-a-api-da-ludopedia_files/figure-html5/cria_app_2-1.png" width="1446" style="display: block; margin: auto;" /></p>
</div>
<p>Se tudo tiver dado certo, você deverá ser levado de volta à página inicial da criação do aplicativo, mas agora perceberá que existem algumas informações adicionais. Duas delas foi você quem definiu - o nome do aplicativo (<code>APP</code>) e a URI de redirecionamento (<code>URIs</code>) -, enquanto as outras três vêm da criação do aplicativo mesmo. Destas, já temos de cara o token de acesso (<code>ACESS_TOKEN (Usuário)</code>) que pode ser guardado e usado diretamente para fazer as requisições à API (com um detalhe importante que já falaremos). A outra informação importante para se guardar é àquela do <code>APP_ID</code>, que será usada para fazer a autenticação de forma programática no R.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>magick</span><span class='fu'>::</span><span class='fu'><a href='https://docs.ropensci.org/magick/reference/editing.html'>image_read</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>'images/cria_app_passo_3.png'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="interagindo-com-a-api-da-ludopedia_files/figure-html5/cria_app_3-1.png" width="1460" style="display: block; margin: auto;" /></p>
</div>
<p>Com isso, fechamos a criação do aplicativo que nos dá acesso à API. Se quisermos consumir os dados da API, basta usar o header <code>AUTHORIZATION</code> nas requisições dos <em>endpoints</em>, passando um <em>string</em> que será composto pela palavra <code>Bearer</code>, um espaço, e o código do token de acesso (<em>e.g.</em>, <code>Bearer &lt;token_de_acesso&gt;</code>). Se, por outro lado, forem outras pessoas que usarão seu aplicativo, então precisaremos ter uma forma de entregar esse token de acesso à elas. É à essa tarefa que vamos passar agora.</p>
<h2 id="pegando-o-token">Pegando o Token</h2>
<p>Ainda seguindo a documentação da API, e simplificando o que está escrito por lá, a aquisição de um token de acesso pelo usuário é feita pelo seu direcionamento para a <code>url</code> de autorização da API - <code>https://ludopedia.com.br/oauth</code> -, junto dos parâmetros <code>APP_ID</code> e <code>REDIRECT URI</code> que você obteve ao criar o aplicativo. Nessa parte, a documentação segue em frente para explicar mais um monte de coisas sobre a forma como a requisição deve ser feita, e que acaba ficando muito confusa. Entretanto, duas instruções são importantes: (1) uma vez que a autorização é feita, a requisição de acesso do token deve ser encaminhada para a <code>url</code> <code>https://ludopedia.com.br/tokenrequest/</code> e, como resposta, (2) essa <code>url</code> retornará um arquivo JSON com o token de acesso. Vamos operacionalizar este processo usando as funções disponíveis no pacote <code>httr</code>, onde:</p>
<ol type="1">
<li>Faremos uso função <code>httr::oauth_endpoint</code> para definir os <em>endpoints</em> de autorização e requisição do token de acesso. Para isso, definiremos os argumentos <code>authorize = https://ludopedia.com.br/oauth</code> e <code>access = 'https://ludopedia.com.br/tokenrequest/'</code>, deixando o argumento <code>request</code> como <code>NULL</code>;<br />
</li>
<li>Usaremos a função <code>httr::oauth_app</code> para submeter as credenciais de acesso para a autenticação, o que nos trará como resultado a chave que trocaremos posteriormente pelo token de acesso. Essa função levará como argumentos o nome do aplicativo (<code>appname = &lt;nome do seu aplicativo&gt;</code>) e a URI de Retorno de Autorização (<code>redirect_uri = &lt;URI de retorno&gt;</code>) que você criou, além do <code>APP_ID</code> que foi gerado depois que você criou o aplicativo no portal da Ludopedia (<code>key = &lt;APP_ID do seu aplicativo&gt;</code>); e,<br />
</li>
<li>Usaremos a função <code>httr::init_oauth2.0</code> para trocar a chave pelo token de acesso através dos <em>endpoints</em> que definimos. Essa função leva dois argumentos: o objeto criado no item 1 acima irá para o argumento <code>endpoint</code>, e o objeto do item 2 irá para o argumento <code>app</code>.</li>
</ol>
<p>Se tudo estiver certo, a função <code>httr::init_oauth2.0</code> deve retornar um arquivo JSON (que você possivelmente visualizará como uma lista no R) onde um dos elementos é o <code>access_token</code>. Com isso, basta juntar este elemento com o <em>string</em> <code>Bearer</code> (que está dentro do elemento <code>token_type</code> no mesmo arquivo JSON), e teremos o token de acesso completo que deve ser usado nas requisições para a API. Falando nisso, vou usar a função que criamos abaixo para pegar o token de acesso que usaremos durante esse post.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># carregando pacotes</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span> <span class='co'># core</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://arxiv.org/abs/1403.2805'>jsonlite</a></span><span class='op'>)</span> <span class='co'># para arquivos json</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://httr.r-lib.org/'>httr</a></span><span class='op'>)</span> <span class='co'># para o scraping</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://fs.r-lib.org'>fs</a></span><span class='op'>)</span> <span class='co'># para mexer com paths</span>

<span class='co'># função para fazer a autenticacao do aplicativo</span>
<span class='va'>pegar_access_token</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>APP</span>, <span class='va'>APP_ID</span>, <span class='va'>URIs</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='co'># setando o endpoint de acordo com os dados fornecidos na ludopedia</span>
  <span class='va'>ludopedia_endpoint</span> <span class='op'>&lt;-</span> <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/oauth_endpoint.html'>oauth_endpoint</a></span><span class='op'>(</span>
    request <span class='op'>=</span> <span class='cn'>NULL</span>,
    authorize <span class='op'>=</span> <span class='st'>'https://ludopedia.com.br/oauth/'</span>,
    access <span class='op'>=</span> <span class='st'>'https://ludopedia.com.br/tokenrequest/'</span>
  <span class='op'>)</span>
  
  <span class='co'># setando as configurações do aplicativo conforme definido no site da ludopedia</span>
  <span class='va'>ludopedia_app</span> <span class='op'>&lt;-</span> <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/oauth_app.html'>oauth_app</a></span><span class='op'>(</span>
    appname <span class='op'>=</span> <span class='va'>APP</span>,
    key <span class='op'>=</span> <span class='va'>APP_ID</span>,
    secret <span class='op'>=</span> <span class='cn'>NULL</span>,
    redirect_uri <span class='op'>=</span> <span class='va'>URIs</span>
  <span class='op'>)</span>
  
  <span class='co'># pegando a autorizacao através do OAUTH2.0</span>
  <span class='va'>autorizacao</span> <span class='op'>&lt;-</span> <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/init_oauth2.0.html'>init_oauth2.0</a></span><span class='op'>(</span>endpoint <span class='op'>=</span> <span class='va'>ludopedia_endpoint</span>, 
                                     app <span class='op'>=</span> <span class='va'>ludopedia_app</span><span class='op'>)</span>
  
  <span class='co'># criando string do token</span>
  <span class='va'>access_token</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>autorizacao</span><span class='op'>$</span><span class='va'>token_type</span>, <span class='st'>' '</span>, <span class='va'>autorizacao</span><span class='op'>$</span><span class='va'>access_token</span><span class='op'>)</span>
  
  <span class='co'># retornando o token de acesso</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>access_token</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># fazendo a autenticacao no portal</span>
<span class='va'>meu_token</span> <span class='op'>&lt;-</span> <span class='fu'>pegar_access_token</span><span class='op'>(</span>
  APP <span class='op'>=</span> <span class='st'>'meu_app'</span>, 
  APP_ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>'app_id'</span><span class='op'>)</span>, 
  URIs <span class='op'>=</span> <span class='st'>'http://localhost:1410/'</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="interagindo-com-a-api">Interagindo com a API</h1>
<p>De posse do token de acesso, vamos explorar as funcionalidades da API da Ludopedia. A ideia aqui não é cobrir todos os <em>endpoints</em> disponíveis, mas apenas focar em um ou outro que serão importantes em posts futuros. Nesse contexto, trabalharemos com dois tipos principais de <em>enpoints</em>: aquele que retorna a lista dos jogos cadastrados no portal da Ludopedia e o outro que retorna os seus metadados. Vamos começar criando repositórios para armazenar cada uma das informações que formos trabalhando.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## definindo os paths temporarios que serao usados</span>
<span class='va'>path_para_jogos</span> <span class='op'>&lt;-</span> <span class='st'>'temporario_jogos'</span>
<span class='va'>path_para_metadata</span> <span class='op'>&lt;-</span> <span class='st'>'temporario_metadados'</span>

<span class='co'>## criando pasta para guardar a tabela com a lista de jogos</span>
<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'>dir_exists</span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_para_jogos</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'>dir_create</span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_para_jogos</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## criando pasta para guardar a tabela com os metadados dos jogos</span>
<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'>dir_exists</span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_para_metadata</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'>dir_create</span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_para_metadata</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h2 id="pegando-a-lista-de-jogos">Pegando a lista de jogos</h2>
<p>O primeiro <em>endpoint</em> que exploraremos é aquele que retorna a lista de jogos cadastrados no portal da Ludopedia. Para facilitar o uso deste <em>endpoint</em>, escrevi a função <code>pega_lista_jogos</code> abaixo, que já traz o endereço do <em>endpoint</em>, junto do <code>header</code> com o token de acesso (<em>i.e.</em>, <code>add_headers(AUTHORIZATION = access_token)</code>) e uma lista com os parâmetros da <em>query</em> que precisa ser feita. Embora hajam alguns parâmetros disponíveis para esta <em>query</em>, focaremos em dois deles aqui: <code>rows</code>, que define a quantidade máxima de jogos que teremos como resposta por requisição (o limite é naturalmente 100 jogos por requisição, mas decidi deixar isso claro na função), e <code>page</code>, que define a página da lista dos jogos cadastrados que buscaremos (mais sobre isso no outro parágrafo). Como de costume, salvamos o arquivo JSON que recebemos de resposta em disco, de forma a acessá-lo à qualquer outro momento sem ter que ficar repetindo a requisição.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># função para pegar todos os jogos em uma dada página</span>
<span class='va'>pegar_lista_jogos</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>pagina</span>, <span class='va'>access_token</span>, <span class='va'>path_salvar</span> <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># pegando os jogos da pagina selecionada</span>
  <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span><span class='st'>'https://ludopedia.com.br/api/v1/jogos'</span>, 
            <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/add_headers.html'>add_headers</a></span><span class='op'>(</span>AUTHORIZATION <span class='op'>=</span> <span class='va'>access_token</span><span class='op'>)</span>,
            query <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fl'>100</span>, page <span class='op'>=</span> <span class='va'>pagina</span><span class='op'>)</span>,
            <span class='fu'>write_disk</span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_glue.html'>str_glue</a></span><span class='op'>(</span><span class='va'>path_salvar</span>, <span class='st'>'/lista_jogos_pagina_{pagina}.json'</span><span class='op'>)</span>,
                       overwrite <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># pegando a primeira pagina da lista de jogos</span>
<span class='va'>lista</span> <span class='op'>&lt;-</span> <span class='fu'>pegar_lista_jogos</span><span class='op'>(</span>pagina <span class='op'>=</span> <span class='fl'>1</span>, access_token <span class='op'>=</span> <span class='va'>meu_token</span>, path_salvar <span class='op'>=</span> <span class='va'>path_para_jogos</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>O parser do arquivo que recebemos não tem muito mistério. Precisaremos carregar o arquivo de resposta salvo em disco usando a função <code>jsonlite::read_json</code> e definindo o argumento <code>simplifyDataFrame = TRUE</code>, para estruturarmos tudo o que conseguirmos como um <code>data.frame</code>. O objeto resultante dessa operação será uma lista, onde o primeiro elemento, <code>jogos</code>, será a tabela com a lista dos 100 jogos disponíveis na primeira página da API. Focando neste elemento, precisaremos de mais um tratamento para passar o <code>data.frame</code> com a lista de jogos para um <code>tibble</code> e, eventuamente, colocá-la em um formato tal que não hajam <code>list-columns</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># função para parsear uma pagina contendo a lista de jogos cadastrados na base da Ludopedia</span>
<span class='va'>parser_lista_jogos</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>target_path</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># carregando o arquivo json</span>
  <span class='fu'>jsonlite</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/jsonlite/man/read_json.html'>read_json</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>target_path</span>, simplifyDataFrame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># extraindo o elemento correspondente aos jogos</span>
    <span class='fu'>pluck</span><span class='op'>(</span><span class='st'>'jogos'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># colocando como tibble</span>
    <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='co'># deixando a tibble desaninhada</span>
    <span class='fu'>unnest</span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'>everything</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># aplicando o parser da lista de jogos</span>
<span class='fu'>parser_lista_jogos</span><span class='op'>(</span>target_path <span class='op'>=</span> <span class='fu'>dir_ls</span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>path_para_jogos</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id_jogo"],"name":[1],"type":["chr"],"align":["left"]},{"label":["nm_jogo"],"name":[2],"type":["chr"],"align":["left"]},{"label":["nm_original"],"name":[3],"type":["chr"],"align":["left"]},{"label":["thumb"],"name":[4],"type":["chr"],"align":["left"]},{"label":["link"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"8176","2":"Dungeons & Dragons (5ª Edição): Livro do Jogador","3":"Dungeons & Dragons (5th Edition): Player's Handbook (D&D 5e)","4":"https://storage.googleapis.com/ludopedia-capas/8176_t.jpg","5":"jogo/dungeons-dragons-5th-edition-player-s-handbook-d-d-5e"},{"1":"13749","2":"Projeto Gaia","3":"Gaia Project","4":"https://storage.googleapis.com/ludopedia-capas/13749_t.jpg","5":"jogo/gaia-project"},{"1":"8858","2":"Terraforming Mars","3":"Terraforming Mars","4":"https://storage.googleapis.com/ludopedia-capas/8858_t.jpg","5":"jogo/terraforming-mars"},{"1":"21102","2":"Vampiro: A Máscara","3":"Vampire: The Masquerade (2nd Edition)","4":"https://storage.googleapis.com/ludopedia-capas/21102_t.jpg","5":"jogo/vampire-the-masquerade-2nd-edition"},{"1":"14902","2":"Dungeons & Dragons 3.5a. Edição: Livro do Jogador","3":"Player's Handbook (D&D 3.5e)","4":"https://storage.googleapis.com/ludopedia-capas/14902_t.jpg","5":"jogo/player-s-handbook-d-d-3-5e"},{"1":"8624","2":"Gloomhaven","3":"Gloomhaven","4":"https://storage.googleapis.com/ludopedia-capas/8624_t.jpg","5":"jogo/gloomhaven"},{"1":"12713","2":"Captive","3":"Graphic Novel Adventures: Captive","4":"https://storage.googleapis.com/ludopedia-capas/12713_t.jpg","5":"jogo/graphic-novel-adventures-captive"},{"1":"404","2":"Terra Mystica","3":"Terra Mystica","4":"https://storage.googleapis.com/ludopedia-capas/404_t.jpg","5":"jogo/terra-mystica"},{"1":"13196","2":"Brass: Lancashire","3":"Brass: Lancashire","4":"https://storage.googleapis.com/ludopedia-capas/13196_t.jpg","5":"jogo/brass-lancashire"},{"1":"13411","2":"GURPS - Módulo Básico (Segunda Edição)","3":"GURPS Basic Set (Second Edition)","4":"https://storage.googleapis.com/ludopedia-capas/13411_t.jpg","5":"jogo/gurps-basic-set-second-edition"},{"1":"13494","2":"Brass: Birmingham","3":"Brass: Birmingham","4":"https://storage.googleapis.com/ludopedia-capas/13494_t.jpg","5":"jogo/brass-birmingham"},{"1":"19085","2":"Chamado de Cthulhu (7ª Edição) - Livro do Guardião","3":"Call of Cthulhu (7th Edition) - Keeper Rulebook","4":"https://storage.googleapis.com/ludopedia-capas/19085_t.jpg","5":"jogo/call-of-cthulhu-7th-edition-keeper-rulebook"},{"1":"14901","2":"Dungeons & Dragons 3a. Edição: Livro do Jogador","3":"Player's Handbook (D&D 3e)","4":"https://storage.googleapis.com/ludopedia-capas/14901_t.jpg","5":"jogo/player-s-handbook-d-d-3e"},{"1":"14910","2":"Twilight Imperium (Quarta Edição)","3":"Twilight Imperium (Fourth Edition)","4":"https://storage.googleapis.com/ludopedia-capas/14910_t.jpg","5":"jogo/twilight-imperium-fourth-edition"},{"1":"27900","2":"Hitodama - A Jornada das almas","3":"Hitodama - A Jornada das almas","4":"https://storage.googleapis.com/ludopedia-capas/27900_t.jpg","5":"jogo/hitodama-a-jornada-das-almas"},{"1":"17559","2":"Mage Knight: Edição Definitiva","3":"Mage Knight: Ultimate Edition","4":"https://storage.googleapis.com/ludopedia-capas/17559_t.jpg","5":"jogo/mage-knight-ultimate-edition"},{"1":"12731","2":"D&D (5ª Edição): Kit Introdutório","3":"Dungeons & Dragons Starter Set","4":"https://storage.googleapis.com/ludopedia-capas/12731_t.jpg","5":"jogo/dungeons-dragons-starter-set"},{"1":"10168","2":"Great Western Trail","3":"Great Western Trail","4":"https://storage.googleapis.com/ludopedia-capas/10168_t.jpg","5":"jogo/great-western-trail"},{"1":"8285","2":"7 Wonders Duel","3":"7 Wonders Duel","4":"https://storage.googleapis.com/ludopedia-capas/8285_t.jpg","5":"jogo/7-wonders-duel"},{"1":"7863","2":"GURPS - Módulo Básico (Primeira Edição)","3":"GURPS Basic Set (First Edition)","4":"https://storage.googleapis.com/ludopedia-capas/7863_t.jpg","5":"jogo/gurps-basic-set-first-edition"},{"1":"13588","2":"Clãs da Caledônia","3":"Clans of Caledonia","4":"https://storage.googleapis.com/ludopedia-capas/13588_t.jpg","5":"jogo/clans-of-caledonia"},{"1":"21129","2":"Mago: A Ascensão","3":"Mage: The Ascension (2nd Edition)","4":"https://storage.googleapis.com/ludopedia-capas/21129_t.jpg","5":"jogo/mage-the-ascension-2nd-edition"},{"1":"9426","2":"Dungeon World Roleplaying Game","3":"Dungeon World Roleplaying Game","4":"https://storage.googleapis.com/ludopedia-capas/9426_t.jpg","5":"jogo/dungeon-world-roleplaying-game"},{"1":"9330","2":"Star Wars: Rebellion","3":"Star Wars: Rebellion","4":"https://storage.googleapis.com/ludopedia-capas/9330_t.jpg","5":"jogo/star-wars-rebellion"},{"1":"187","2":"The Castles of Burgundy","3":"The Castles of Burgundy","4":"https://storage.googleapis.com/ludopedia-capas/187_t.jpg","5":"jogo/the-castles-of-burgundy"},{"1":"11110","2":"Tormenta RPG - Edição Revisada","3":"Tormenta RPG - Edição Revisada","4":"https://storage.googleapis.com/ludopedia-capas/11110_t.jpg","5":"jogo/tormenta-rpg-edicao-revisada"},{"1":"48","2":"Puerto Rico","3":"Puerto Rico","4":"https://storage.googleapis.com/ludopedia-capas/48_t.jpg","5":"jogo/puerto-rico"},{"1":"22056","2":"Tormenta 20: Livro Básico","3":"Tormenta 20: Livro Básico","4":"https://storage.googleapis.com/ludopedia-capas/22056_t.jpg","5":"jogo/tormenta-20-livro-basico"},{"1":"2614","2":"First Quest - Advanced Dungeons & Dragons 2ª Edition","3":"First Quest","4":"https://storage.googleapis.com/ludopedia-capas/2614_t.jpg","5":"jogo/first-quest"},{"1":"11478","2":"Lisboa","3":"Lisboa","4":"https://storage.googleapis.com/ludopedia-capas/11478_t.jpg","5":"jogo/lisboa"},{"1":"32437","2":"Aventuras na Era Hiboriana RPG","3":"Aventuras na Era Hiboriana RPG","4":"https://storage.googleapis.com/ludopedia-capas/32437_t.jpg","5":"jogo/aventuras-na-era-hiboriana-rpg"},{"1":"20418","2":"Wingspan","3":"Wingspan","4":"https://storage.googleapis.com/ludopedia-capas/20418_t.jpg","5":"jogo/wingspan"},{"1":"12600","2":"Pathfinder RPG: Livro Básico","3":"Pathfinder Roleplaying Game Core Rulebook","4":"https://storage.googleapis.com/ludopedia-capas/12600_t.jpg","5":"jogo/pathfinder-roleplaying-game-core-rulebook"},{"1":"503","2":"Twilight Struggle","3":"Twilight Struggle","4":"https://storage.googleapis.com/ludopedia-capas/503_t.jpg","5":"jogo/twilight-struggle"},{"1":"8149","2":"Star Wars: Fronteira do Império - Livro Básico","3":"Star Wars: Edge of the Empire Core Rulebook","4":"https://storage.googleapis.com/ludopedia-capas/8149_t.jpg","5":"jogo/star-wars-edge-of-the-empire-core-rulebook"},{"1":"11425","2":"Um Banquete a Odin","3":"A Feast for Odin","4":"https://storage.googleapis.com/ludopedia-capas/11425_t.jpg","5":"jogo/a-feast-for-odin"},{"1":"20829","2":"O Senhor dos Anéis: Jornadas na Terra Média","3":"The Lord of the Rings: Journeys in Middle-earth","4":"https://storage.googleapis.com/ludopedia-capas/20829_t.jpg","5":"jogo/the-lord-of-the-rings-journeys-in-middle-earth"},{"1":"1500","2":"Old Dragon: Módulo Básico","3":"Old Dragon: Módulo Básico","4":"https://storage.googleapis.com/ludopedia-capas/1500_t.jpg","5":"jogo/old-dragon-modulo-basico"},{"1":"23555","2":"Lobisomem: O Apocalipse","3":"Werewolf: The Apocalypse (2nd Edition)","4":"https://storage.googleapis.com/ludopedia-capas/23555_t.jpg","5":"jogo/werewolf-the-apocalypse-2nd-edition"},{"1":"10959","2":"Spirit Island","3":"Spirit Island","4":"https://storage.googleapis.com/ludopedia-capas/10959_t.jpg","5":"jogo/spirit-island"},{"1":"14605","2":"O Mundo das Trevas","3":"World of Darkness","4":"https://storage.googleapis.com/ludopedia-capas/14605_t.jpg","5":"jogo/world-of-darkness"},{"1":"8627","2":"Through The Ages: Uma Nova História da Civilização","3":"Through the Ages: A New Story of Civilization","4":"https://storage.googleapis.com/ludopedia-capas/8627_t.jpg","5":"jogo/through-the-ages-a-new-story-of-civilization"},{"1":"22504","2":"Pathfinder 2ª Edição - Livro Básico","3":"Pathfinder Core Rulebook (2nd Edition)","4":"https://storage.googleapis.com/ludopedia-capas/22504_t.jpg","5":"jogo/pathfinder-core-rulebook-2nd-edition"},{"1":"6764","2":"Scythe","3":"Scythe","4":"https://storage.googleapis.com/ludopedia-capas/6764_t.jpg","5":"jogo/scythe"},{"1":"11112","2":"Mansions of Madness (2ª Edição)","3":"Mansions of Madness (Second Edition)","4":"https://storage.googleapis.com/ludopedia-capas/11112_t.jpg","5":"jogo/mansions-of-madness-second-edition"},{"1":"14816","2":"Numenera","3":"Numenera","4":"https://storage.googleapis.com/ludopedia-capas/14816_t.jpg","5":"jogo/numenera"},{"1":"26076","2":"A Herança de Cthulhu","3":"A Herança de Cthulhu","4":"https://storage.googleapis.com/ludopedia-capas/26076_t.jpg","5":"jogo/a-heranca-de-cthulhu"},{"1":"5058","2":"Five Tribes","3":"Five Tribes","4":"https://storage.googleapis.com/ludopedia-capas/5058_t.jpg","5":"jogo/five-tribes"},{"1":"433","2":"Guerra do Anel (Segunda Edição)","3":"War of the Ring (second edition)","4":"https://storage.googleapis.com/ludopedia-capas/433_t.jpg","5":"jogo/war-of-the-ring-second-edition"},{"1":"24635","2":"Vampiro - Sozinho na Escuridão","3":"Vampiro - Sozinho na Escuridão","4":"https://storage.googleapis.com/ludopedia-capas/24635_t.jpg","5":"jogo/vampiro-sozinho-na-escuridao"},{"1":"16910","2":"A Cidade de Your Town","3":"Graphic Novel Adventures: Your Town","4":"https://storage.googleapis.com/ludopedia-capas/16910_t.jpg","5":"jogo/graphic-novel-adventures-your-town"},{"1":"7231","2":"Pandemic Legacy: 1ª Temporada","3":"Pandemic Legacy: Season 1","4":"https://storage.googleapis.com/ludopedia-capas/7231_t.jpg","5":"jogo/pandemic-legacy-season-1"},{"1":"17609","2":"Castelo Falkenstein: Livro de Regras","3":"Castle Falkenstein","4":"https://storage.googleapis.com/ludopedia-capas/17609_t.jpg","5":"jogo/castle-falkenstein"},{"1":"15950","2":"Root","3":"Root","4":"https://storage.googleapis.com/ludopedia-capas/15950_t.jpg","5":"jogo/root"},{"1":"170","2":"Mage Knight Board Game","3":"Mage Knight Board Game","4":"https://storage.googleapis.com/ludopedia-capas/170_t.jpg","5":"jogo/mage-knight-board-game"},{"1":"17554","2":"Old Dragon Aprimorado","3":"Old Dragon Aprimorado","4":"https://storage.googleapis.com/ludopedia-capas/17554_t.jpg","5":"jogo/old-dragon-aprimorado"},{"1":"14981","2":"Azul","3":"Azul","4":"https://storage.googleapis.com/ludopedia-capas/14981_t.jpg","5":"jogo/azul"},{"1":"14947","2":"O Um Anel: Aventuras Além do Limiar do Ermo","3":"The One Ring: Adventures over the Edge of the Wild","4":"https://storage.googleapis.com/ludopedia-capas/14947_t.jpg","5":"jogo/the-one-ring-adventures-over-the-edge-of-the-wild"},{"1":"11178","2":"Clank!: Um Deck Building de Aventura","3":"Clank!: A Deck-Building Adventure","4":"https://storage.googleapis.com/ludopedia-capas/11178_t.jpg","5":"jogo/clank-a-deck-building-adventure"},{"1":"15097","2":"Livro do Jogador (AD&D 2e Revisado)","3":"Player's Handbook (AD&D 2e Revised)","4":"https://storage.googleapis.com/ludopedia-capas/15097_t.jpg","5":"jogo/player-s-handbook-ad-d-2e-revised"},{"1":"7333","2":"As Viagens de Marco Polo","3":"The Voyages of Marco Polo","4":"https://storage.googleapis.com/ludopedia-capas/7333_t.jpg","5":"jogo/the-voyages-of-marco-polo"},{"1":"14828","2":"Zumbis!","3":"Zombies (I)","4":"https://storage.googleapis.com/ludopedia-capas/14828_t.jpg","5":"jogo/zombies-i"},{"1":"23742","2":"Notequest","3":"Notequest","4":"https://storage.googleapis.com/ludopedia-capas/23742_t.jpg","5":"jogo/notequest"},{"1":"134","2":"Trajan","3":"Trajan","4":"https://storage.googleapis.com/ludopedia-capas/134_t.jpg","5":"jogo/trajan"},{"1":"14601","2":"Savage Worlds: Livro de Regras","3":"Savage Worlds Deluxe","4":"https://storage.googleapis.com/ludopedia-capas/14601_t.jpg","5":"jogo/savage-worlds-deluxe"},{"1":"9711","2":"Viticulture - Edição Essencial","3":"Viticulture Essential Edition","4":"https://storage.googleapis.com/ludopedia-capas/9711_t.jpg","5":"jogo/viticulture-essential-edition"},{"1":"14517","2":"FF 01 — O Feiticeiro da Montanha de Fogo","3":"The Warlock of Firetop Mountain (I)","4":"https://storage.googleapis.com/ludopedia-capas/14517_t.jpg","5":"jogo/the-warlock-of-firetop-mountain-i"},{"1":"16085","2":"Teotihuacan: City of Gods","3":"Teotihuacan: City of Gods","4":"https://storage.googleapis.com/ludopedia-capas/16085_t.jpg","5":"jogo/teotihuacan-city-of-gods"},{"1":"25895","2":"As Ruínas Perdidas de Arnak","3":"Lost Ruins of Arnak","4":"https://storage.googleapis.com/ludopedia-capas/25895_t.jpg","5":"jogo/lost-ruins-of-arnak"},{"1":"21138","2":"Vampire: The Dark Ages","3":"Vampire: The Dark Ages","4":"https://storage.googleapis.com/ludopedia-capas/21138_t.jpg","5":"jogo/vampire-the-dark-ages"},{"1":"1860","2":"Caverna: The Cave Farmers","3":"Caverna: The Cave Farmers","4":"https://storage.googleapis.com/ludopedia-capas/1860_t.jpg","5":"jogo/caverna-the-cave-farmers"},{"1":"16912","2":"Lobisomem","3":"Graphic Novel Adventures: Loup Garou","4":"https://storage.googleapis.com/ludopedia-capas/16912_t.jpg","5":"jogo/graphic-novel-adventures-loup-garou"},{"1":"8598","2":"Dungeoneer - Aventuras Fantásticas","3":"Dungeoneer","4":"https://storage.googleapis.com/ludopedia-capas/8598_t.jpg","5":"jogo/dungeoneer"},{"1":"133","2":"Ticket to Ride: Europa","3":"Ticket to Ride: Europe","4":"https://storage.googleapis.com/ludopedia-capas/133_t.jpg","5":"jogo/ticket-to-ride-europe"},{"1":"18993","2":"Barrage","3":"Barrage","4":"https://storage.googleapis.com/ludopedia-capas/18993_t.jpg","5":"jogo/barrage"},{"1":"14836","2":"Lenda dos Cinco Anéis 4ª Edição RPG","3":"Legend of the Five Rings 4th Edition RPG","4":"https://storage.googleapis.com/ludopedia-capas/14836_t.jpg","5":"jogo/legend-of-the-five-rings-4th-edition-rpg"},{"1":"8424","2":"Mombasa","3":"Mombasa","4":"https://storage.googleapis.com/ludopedia-capas/8424_t.jpg","5":"jogo/mombasa"},{"1":"20275","2":"Vampiro: A Máscara (5ª Edição)","3":"Vampire: The Masquerade 5th Edition Core Book","4":"https://storage.googleapis.com/ludopedia-capas/20275_t.jpg","5":"jogo/vampire-the-masquerade-5th-edition-core-book"},{"1":"10405","2":"Four Against Darkness","3":"Four Against Darkness","4":"https://storage.googleapis.com/ludopedia-capas/10405_t.jpg","5":"jogo/four-against-darkness"},{"1":"422","2":"Tzolk'in: O Calendário Maia","3":"Tzolk'in: The Mayan Calendar","4":"https://storage.googleapis.com/ludopedia-capas/422_t.jpg","5":"jogo/tzolk-in-the-mayan-calendar"},{"1":"22092","2":"Shadowrun","3":"Shadowrun","4":"https://storage.googleapis.com/ludopedia-capas/22092_t.jpg","5":"jogo/shadowrun"},{"1":"9611","2":"Tiranos da Umbreterna","3":"Tyrants of the Underdark","4":"https://storage.googleapis.com/ludopedia-capas/9611_t.jpg","5":"jogo/tyrants-of-the-underdark"},{"1":"23140","2":"Azul: Pavilhão de Verão","3":"Azul: Summer Pavilion","4":"https://storage.googleapis.com/ludopedia-capas/23140_t.jpg","5":"jogo/azul-summer-pavilion"},{"1":"17883","2":"Fate - Sistema Básico","3":"Fate Core System","4":"https://storage.googleapis.com/ludopedia-capas/17883_t.jpg","5":"jogo/fate-core-system"},{"1":"14346","2":"Brazil: Imperial","3":"Brazil: Imperial","4":"https://storage.googleapis.com/ludopedia-capas/14346_t.jpg","5":"jogo/brazil-imperial"},{"1":"26472","2":"Tormenta20: Livro Básico Edição de Luxo","3":"Tormenta20 — Livro Básico Edição de Luxo","4":"https://storage.googleapis.com/ludopedia-capas/26472_t.jpg","5":"jogo/tormenta20-livro-basico-edicao-de-luxo"},{"1":"13774","2":"Dungeon Crawl Classics Role Playing Game - DCC RPG","3":"Dungeon Crawl Classics Role Playing Game - DCC RPG","4":"https://storage.googleapis.com/ludopedia-capas/13774_t.jpg","5":"jogo/dungeon-crawl-classics-role-playing-game-dcc-rpg"},{"1":"4699","2":"La Granja","3":"La Granja","4":"https://storage.googleapis.com/ludopedia-capas/4699_t.jpg","5":"jogo/la-granja"},{"1":"10672","2":"Agricola (Edição Revisada)","3":"Agricola (revised edition)","4":"https://storage.googleapis.com/ludopedia-capas/10672_t.jpg","5":"jogo/agricola-revised-edition"},{"1":"15423","2":"FF 05 — A Cidade dos Ladrões","3":"City of Thieves","4":"https://storage.googleapis.com/ludopedia-capas/15423_t.jpg","5":"jogo/city-of-thieves"},{"1":"21822","2":"Maracaibo","3":"Maracaibo","4":"https://storage.googleapis.com/ludopedia-capas/21822_t.jpg","5":"jogo/maracaibo"},{"1":"21610","2":"Tales from the Loop","3":"Tales from the Loop","4":"https://storage.googleapis.com/ludopedia-capas/21610_t.jpg","5":"jogo/tales-from-the-loop"},{"1":"2194","2":"Concordia","3":"Concordia","4":"https://storage.googleapis.com/ludopedia-capas/2194_t.jpg","5":"jogo/concordia"},{"1":"15233","2":"Dungeons & Dragons 4a. Edição: Livro do Jogador","3":"Player's Handbook (D&D 4e)","4":"https://storage.googleapis.com/ludopedia-capas/15233_t.jpg","5":"jogo/player-s-handbook-d-d-4e"},{"1":"15752","2":"Hora de Aventura: Roleplaying Game","3":"Hora de Aventuras: Juego de Rol RPG","4":"https://storage.googleapis.com/ludopedia-capas/15752_t.jpg","5":"jogo/hora-de-aventuras-juego-de-rol-rpg"},{"1":"111","2":"Power Grid","3":"Power Grid","4":"https://storage.googleapis.com/ludopedia-capas/111_t.jpg","5":"jogo/power-grid"},{"1":"13814","2":"Fiasco","3":"Fiasco","4":"https://storage.googleapis.com/ludopedia-capas/13814_t.jpg","5":"jogo/fiasco"},{"1":"366","2":"Robinson Crusoé: Aventuras na Ilha Amaldiçoada","3":"Robinson Crusoe: Adventures on the Cursed Island","4":"https://storage.googleapis.com/ludopedia-capas/366_t.jpg","5":"jogo/robinson-crusoe-adventures-on-the-cursed-island"},{"1":"14364","2":"FF 02 — A Cidadela do Caos","3":"The Citadel of Chaos","4":"https://storage.googleapis.com/ludopedia-capas/14364_t.jpg","5":"jogo/the-citadel-of-chaos"},{"1":"98","2":"Lords of Waterdeep","3":"Lords of Waterdeep","4":"https://storage.googleapis.com/ludopedia-capas/98_t.jpg","5":"jogo/lords-of-waterdeep"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<p>Com base nessa informação, já temos acesso a lista de alguns jogos cadastrados no portal da Ludopedia, No entanto, ainda há o segundo elemento daquela lista que acabamos de parsear, <code>total</code>, que nos informa sobre a quantidade total de jogos cadastrados. Para pegar esta informação, basta mudarmos o <em>string</em> que passamos para a função <code>pluck</code>, conforme apresentado abaixo.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># função para pegar a quantidade total de jogos disponiveis</span>
<span class='va'>pegar_total_jogos</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>access_token</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># faz um GET da pagina default dos jogos, parseia o conteudo e pega so o elemento</span>
  <span class='co'># da lista que contem a quantidade total de jogos cadastrados na base da Ludopedia</span>
  <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span><span class='st'>'https://ludopedia.com.br/api/v1/jogos'</span>, 
            <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/add_headers.html'>add_headers</a></span><span class='op'>(</span>AUTHORIZATION <span class='op'>=</span> <span class='va'>access_token</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/content.html'>content</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/pluck.html'>pluck</a></span><span class='op'>(</span><span class='st'>'total'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>parse_integer</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># pegando o total de jogos cadastrados na ludopedia</span>
<span class='va'>total_de_jogos</span> <span class='op'>&lt;-</span> <span class='fu'>pegar_total_jogos</span><span class='op'>(</span>access_token <span class='op'>=</span> <span class='va'>meu_token</span><span class='op'>)</span>
<span class='va'>total_de_jogos</span>
</code></pre>
</div>
<pre><code>[1] 32239</code></pre>
</div>
<p>Como podemos notar, existem 32.239 cadastrados no portal da Ludopedia. Como temos acesso à 100 jogos por página da requisição, isto nos diz que precisaremos percorrer 32.239 / 100 = 322.39 = 323 páginas para obter a lista de <strong>todos</strong> os jogos disponíveis (<em>i.e.</em>, total de jogos dividido por 100, arredondando o resultado para cima). Assim, bastaria iterar os valores do argumento <code>pagina</code> da função <code>pegar_lista_jogos</code> do índice 1 até o número de páginas definido acima dentro de um <code>purrr::map</code>, por exemplo.</p>
<p>Usamos o <em>endpoint</em> da lista de jogos cadastrados para obter os nomes dos jogos e o seu identificador numérico único, o que é ótimo se não tivermos noção do nome dos jogos nem nada do gênero. Por outro lado, se tivermos um jogo específico em mente e quisermos obter apenas o seu identificador numérico, podemos passar o seu nome como um argumento para a <code>query</code> do mesmo <em>endpoint</em> (<code>search = &lt;nome do jogo&gt;</code>). Eu empacotei essa aplicação do <em>endpoint</em> em outra função, e usei como exemplo a busca pelo identificador do jogo <code>Ticket to Ride</code> (que usamos como exemplo lá no post sobre a API XML do BoardGameGeek). O resultado que obtivemos (já parseado) revela que este uso do <em>endpoint</em> traz todos os jogos que, de alguma forma, tenham haver com aquele que buscamos - no nosso caso, também tivemos acesso à todas as expansões e implementações do jogo base.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># função para pegar a lista de jogos que contenham uma string especifica no nome</span>
<span class='va'>pegar_id_jogo</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>nome_do_jogo</span>, <span class='va'>access_token</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># pegando os jogos da pagina selecionada</span>
  <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span><span class='st'>'https://ludopedia.com.br/api/v1/jogos'</span>, 
            <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/add_headers.html'>add_headers</a></span><span class='op'>(</span>AUTHORIZATION <span class='op'>=</span> <span class='va'>access_token</span><span class='op'>)</span>,
            query <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>search <span class='op'>=</span> <span class='va'>nome_do_jogo</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># pegando o exemplo do ticket to ride, como no scrapper do boardgamegekk</span>
<span class='fu'>pegar_id_jogo</span><span class='op'>(</span>nome_do_jogo <span class='op'>=</span> <span class='st'>'Ticket to Ride'</span>, access_token <span class='op'>=</span> <span class='va'>meu_token</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># pegando o content da resposta</span>
  <span class='fu'>content</span><span class='op'>(</span>simplifyDataFrame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># extraindo o elemento jogos de dentro da lista</span>
  <span class='fu'>pluck</span><span class='op'>(</span><span class='st'>'jogos'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># criando a tabela para a visualização na página</span>
  <span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id_jogo"],"name":[1],"type":["chr"],"align":["left"]},{"label":["nm_jogo"],"name":[2],"type":["chr"],"align":["left"]},{"label":["nm_original"],"name":[3],"type":["chr"],"align":["left"]},{"label":["thumb"],"name":[4],"type":["chr"],"align":["left"]},{"label":["link"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"2","2":"Ticket to Ride","3":"Ticket to Ride","4":"https://storage.googleapis.com/ludopedia-capas/2_t.jpg","5":"jogo/ticket-to-ride","_rn_":"1"},{"1":"133","2":"Ticket to Ride: Europa","3":"Ticket to Ride: Europe","4":"https://storage.googleapis.com/ludopedia-capas/133_t.jpg","5":"jogo/ticket-to-ride-europe","_rn_":"2"},{"1":"4176","2":"Ticket to Ride: 10th Anniversary","3":"Ticket to Ride: 10th Anniversary","4":"https://storage.googleapis.com/ludopedia-capas/4176_t.jpg","5":"jogo/ticket-to-ride-10th-anniversary","_rn_":"3"},{"1":"29022","2":"Ticket to Ride: Europa - 15 Anos","3":"Ticket to Ride: Europe – 15th Anniversary","4":"https://storage.googleapis.com/ludopedia-capas/29022_t.jpg","5":"jogo/ticket-to-ride-europe-15th-anniversary","_rn_":"4"},{"1":"10799","2":"Ticket to Ride: Trilhos e Velas","3":"Ticket to Ride: Rails & Sails","4":"https://storage.googleapis.com/ludopedia-capas/10799_t.jpg","5":"jogo/ticket-to-ride-rails-sails","_rn_":"5"},{"1":"958","2":"Ticket to Ride: Países Nórdicos","3":"Ticket to Ride: Nordic Countries","4":"https://storage.googleapis.com/ludopedia-capas/958_t.jpg","5":"jogo/ticket-to-ride-nordic-countries","_rn_":"6"},{"1":"18431","2":"Ticket to Ride: New York","3":"Ticket to Ride: New York","4":"https://storage.googleapis.com/ludopedia-capas/18431_t.jpg","5":"jogo/ticket-to-ride-new-york","_rn_":"7"},{"1":"21961","2":"Ticket to Ride: Londres","3":"Ticket to Ride: London","4":"https://storage.googleapis.com/ludopedia-capas/21961_t.jpg","5":"jogo/ticket-to-ride-london","_rn_":"8"},{"1":"14933","2":"Ticket to Ride: Germany","3":"Ticket to Ride: Germany","4":"https://storage.googleapis.com/ludopedia-capas/14933_t.jpg","5":"jogo/ticket-to-ride-germany","_rn_":"9"},{"1":"957","2":"Ticket to Ride: Märklin","3":"Ticket to Ride: Märklin","4":"https://storage.googleapis.com/ludopedia-capas/957_t.jpg","5":"jogo/ticket-to-ride-marklin","_rn_":"10"},{"1":"12719","2":"Ticket to Ride: Primeira Viagem","3":"Ticket to Ride: First Journey (Europe)","4":"https://storage.googleapis.com/ludopedia-capas/12719_t.jpg","5":"jogo/ticket-to-ride-first-journey-europe","_rn_":"11"},{"1":"960","2":"Ticket to Ride: The Card Game","3":"Ticket to Ride: The Card Game","4":"https://storage.googleapis.com/ludopedia-capas/960_t.jpg","5":"jogo/ticket-to-ride-the-card-game","_rn_":"12"},{"1":"11170","2":"Ticket to Ride: First Journey (U.S.)","3":"Ticket to Ride: First Journey (U.S.)","4":"https://storage.googleapis.com/ludopedia-capas/11170_t.jpg","5":"jogo/ticket-to-ride-first-journey-u-s","_rn_":"13"},{"1":"18311","2":"Ticket To Ride Demo","3":"Ticket To Ride Demo","4":"https://storage.googleapis.com/ludopedia-capas/18311_t.jpg","5":"jogo/ticket-to-ride-demo","_rn_":"14"},{"1":"24692","2":"Ticket to Ride: Amsterdam","3":"Ticket to Ride: Amsterdam","4":"https://storage.googleapis.com/ludopedia-capas/24692_t.jpg","5":"jogo/ticket-to-ride-amsterdam","_rn_":"15"},{"1":"31752","2":"Ticket to Ride: Track Switcher","3":"Ticket to Ride: Track Switcher","4":"https://storage.googleapis.com/ludopedia-capas/31752_t.jpg","5":"jogo/ticket-to-ride-track-switcher","_rn_":"16"},{"1":"9531","2":"Halloween Freighter Ticket to Ride Train & Station Set","3":"Halloween Freighter Ticket to Ride Train & Station Set","4":"https://storage.googleapis.com/ludopedia-capas/9531_t.jpg","5":"jogo/halloween-freighter-ticket-to-ride-train-station-set","_rn_":"17"},{"1":"20682","2":"Ticket to Ride Characters (Fan expansion)","3":"Ticket to Ride Characters (Fan expansion)","4":"https://storage.googleapis.com/ludopedia-capas/20682_t.jpg","5":"jogo/ticket-to-ride-characters-fan-expansion","_rn_":"18"},{"1":"967","2":"Ticket to Ride Map Collection: Volume 3 - The Heart of Africa","3":"Ticket to Ride Map Collection: Volume 3 - The Heart of Africa","4":"https://storage.googleapis.com/ludopedia-capas/967_t.jpg","5":"jogo/ticket-to-ride-map-collection-volume-3-the-heart-of-africa","_rn_":"19"},{"1":"15007","2":"Ticket to Ride Map Collection: Volume 6 – France & Old West","3":"Ticket to Ride Map Collection: Volume 6 – France & Old West","4":"https://storage.googleapis.com/ludopedia-capas/15007_t.jpg","5":"jogo/ticket-to-ride-map-collection-volume-6-france-old-west","_rn_":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<p>Acredito que estas são as funcionalidades básicas mais importantes deste <em>endpoint</em>. Vamos passar ao próximo!</p>
<h2 id="pegando-as-informações-de-um-jogo">Pegando as informações de um jogo</h2>
<p>O outro <em>endpoint</em> que exploraremos é aquele que traz os metadados dos jogos de tabuleiro, e que faz uso do identificador numérico do jogo diretamente na <code>url</code> da requisição. Desta forma, as informações da lista de jogos cadastrados no portal da Ludopedia passa a ser muito importante para utilizarmos este <em>endpoint</em>. Tendo isto em mente, vamos preparar a função <code>pegar_infos_jogo</code> adicionando um argumento que receberá o identificador do jogo (<code>id_jogo</code>) que buscaremos - novamente, utilizando o <code>header</code> com o token de acesso e salvando o arquivo JSON de resposta em disco para usarmos depois. Como exemplo, vamos usar essa função para pegar os metadados do <code>Ticket do Ride</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># função para pegar as informações de um jogo</span>
<span class='va'>pegar_infos_jogo</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>id_jogo</span>, <span class='va'>access_token</span>, <span class='va'>path_salvar</span> <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># pegando os detalhes do jogo</span>
  <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span>url <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_glue.html'>str_glue</a></span><span class='op'>(</span><span class='st'>'https://ludopedia.com.br/api/v1/jogos/{id_jogo}'</span><span class='op'>)</span>, 
            <span class='fu'>add_headers</span><span class='op'>(</span>AUTHORIZATION <span class='op'>=</span> <span class='va'>access_token</span><span class='op'>)</span>,
            <span class='fu'>write_disk</span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_glue.html'>str_glue</a></span><span class='op'>(</span><span class='va'>path_salvar</span>, <span class='st'>'/info_do_jogo_{id_jogo}.json'</span><span class='op'>)</span>,
                       overwrite <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># pegando as informações do Ticket to Ride</span>
<span class='va'>metadados</span> <span class='op'>&lt;-</span> <span class='fu'>pegar_infos_jogo</span><span class='op'>(</span>
  id_jogo <span class='op'>=</span> <span class='fl'>2</span>, 
  access_token <span class='op'>=</span> <span class='va'>meu_token</span>, 
  path_salvar <span class='op'>=</span> <span class='va'>path_para_metadata</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Vamos dar uma olhada na estrutura do arquivo JSON que recebemos como resposta, de forma a saber o que teremos que parsear.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>jsonlite</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/jsonlite/man/read_json.html'>read_json</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'>dir_ls</span><span class='op'>(</span><span class='va'>path_para_metadata</span><span class='op'>)</span>, simplifyDataFrame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='va'>glimpse</span>
</code></pre>
</div>
<pre><code>List of 21
 $ id_jogo         : int 2
 $ nm_jogo         : chr &quot;Ticket to Ride&quot;
 $ thumb           : chr &quot;https://storage.googleapis.com/ludopedia-capas/2_t.jpg&quot;
 $ tp_jogo         : chr &quot;b&quot;
 $ link            : chr &quot;https://www.ludopedia.com.br/jogo/ticket-to-ride&quot;
 $ ano_publicacao  : int 2004
 $ ano_nacional    : int 2014
 $ qt_jogadores_min: int 2
 $ qt_jogadores_max: int 5
 $ mecanicas       :&#39;data.frame&#39;:   3 obs. of  2 variables:
  ..$ id_mecanica: chr [1:3] &quot;3&quot; &quot;18&quot; &quot;15&quot;
  ..$ nm_mecanica: chr [1:3] &quot;Gestão de Mão&quot; &quot;Construção de Rotas&quot; &quot;Seleção de Cartas&quot;
 $ categorias      :&#39;data.frame&#39;:   1 obs. of  2 variables:
  ..$ id_categoria: chr &quot;111&quot;
  ..$ nm_categoria: chr &quot;Jogo de Entrada&quot;
 $ temas           :&#39;data.frame&#39;:   1 obs. of  2 variables:
  ..$ id_tema: chr &quot;27&quot;
  ..$ nm_tema: chr &quot;Transportes&quot;
 $ artistas        :&#39;data.frame&#39;:   2 obs. of  2 variables:
  ..$ id_profissional: chr [1:2] &quot;6&quot; &quot;5&quot;
  ..$ nm_profissional: chr [1:2] &quot;Julien Delval&quot; &quot;Cyrille Daujean&quot;
 $ designers       :&#39;data.frame&#39;:   1 obs. of  2 variables:
  ..$ id_profissional: chr &quot;4&quot;
  ..$ nm_profissional: chr &quot;Alan R. Moon&quot;
 $ vl_tempo_jogo   : int 45
 $ idade_minima    : int 8
 $ qt_tem          : int 3149
 $ qt_teve         : int 382
 $ qt_favorito     : int 443
 $ qt_quer         : int 1831
 $ qt_jogou        : int 3914</code></pre>
</div>
<p>Como podemos ver, existem duas principais estruturas de dados no arquivo. Em uma destas estruturas estão as informações armazenadas em vetores com um único elemento, como o ano de publicação do jogo, informações sobre quantidade de jogadores e título do jogo. A outra estrutura existente no arquivo são algumas informações armazenadas como <code>data.frame</code>, como as informações da mecânica de jogo, os temas e nome dos criadores do jogo. Estas informações estão nesta estrutura pois elas tendem a ser naturalmente multidimensionais, e possivelmente é mais fácil armazená-las em uma estrutura na qual você consiga discriminar o metadado linha a linha. Dada a natureza destas duas estruturas de dados, podemos parsear a primeira delas de forma bem simples, usando a função <code>purrr::discard</code> para descartar todos os elementos do arquivo JSON que sejam um <code>data.frame</code> (<em>i.e.</em>, empregando o teste lógico <code>is.data.frame</code>), e juntando todos os elementos restantes coluna à coluna (<em>i.e.</em>, usando um <code>bind_cols</code>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>jsonlite</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/jsonlite/man/read_json.html'>read_json</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'>dir_ls</span><span class='op'>(</span><span class='va'>path_para_metadata</span><span class='op'>)</span>, simplifyDataFrame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># descartando todos os elementos que sao listas</span>
  <span class='fu'>discard</span><span class='op'>(</span><span class='va'>is.data.frame</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># juntando cada elemento da lista coluna a coluna</span>
  <span class='fu'>bind_cols</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># visualizando a tabela</span>
  <span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id_jogo"],"name":[1],"type":["int"],"align":["right"]},{"label":["nm_jogo"],"name":[2],"type":["chr"],"align":["left"]},{"label":["thumb"],"name":[3],"type":["chr"],"align":["left"]},{"label":["tp_jogo"],"name":[4],"type":["chr"],"align":["left"]},{"label":["link"],"name":[5],"type":["chr"],"align":["left"]},{"label":["ano_publicacao"],"name":[6],"type":["int"],"align":["right"]},{"label":["ano_nacional"],"name":[7],"type":["int"],"align":["right"]},{"label":["qt_jogadores_min"],"name":[8],"type":["int"],"align":["right"]},{"label":["qt_jogadores_max"],"name":[9],"type":["int"],"align":["right"]},{"label":["vl_tempo_jogo"],"name":[10],"type":["int"],"align":["right"]},{"label":["idade_minima"],"name":[11],"type":["int"],"align":["right"]},{"label":["qt_tem"],"name":[12],"type":["int"],"align":["right"]},{"label":["qt_teve"],"name":[13],"type":["int"],"align":["right"]},{"label":["qt_favorito"],"name":[14],"type":["int"],"align":["right"]},{"label":["qt_quer"],"name":[15],"type":["int"],"align":["right"]},{"label":["qt_jogou"],"name":[16],"type":["int"],"align":["right"]}],"data":[{"1":"2","2":"Ticket to Ride","3":"https://storage.googleapis.com/ludopedia-capas/2_t.jpg","4":"b","5":"https://www.ludopedia.com.br/jogo/ticket-to-ride","6":"2004","7":"2014","8":"2","9":"5","10":"45","11":"8","12":"3149","13":"382","14":"443","15":"1831","16":"3914"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<p>A informação que buscaremos extrair da segunda estrutura de dados é àquela associada às colunas que têm o prefixo <code>nm_</code> que contém as <em>strings</em> que definem àquela entidade. Note que em todos esses casos nós estamos interessados em extrair as informações que estão na segunda coluna de cada <code>data.frame</code> e que, portanto, não precisamos focar no nome da coluna em si para ter acesso à elas, apenas na sua posição. Além disso, pode existir mais de um elemento nesta coluna, e precisaremos concatenar estas informações em um <em>string</em> só. Assim, usaremos a função <code>purrr::keep</code> para reter todos os elementos que são um <code>data.frame</code> e, então, extrairemos a segunda coluna de cada uma delas mapeando a função <code>purrr::pull</code>. Finalmente, mapearemos um <code>paste0</code> à cada elemento da lista para concatenar o seu conteúdo a um <em>string</em> só, e usaremos um <code>bind_cols</code> para colocar tudo como um <code>tibble</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># lendo o arquivo JSON com os metadados do jogo</span>
<span class='fu'>jsonlite</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/jsonlite/man/read_json.html'>read_json</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'>dir_ls</span><span class='op'>(</span><span class='va'>path_para_metadata</span><span class='op'>)</span>, simplifyDataFrame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># retendo apenas os elementos que sao dataframes</span>
  <span class='fu'>keep</span><span class='op'>(</span><span class='va'>is.data.frame</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># pegando a coluna que contem os o nome do metadado</span>
  <span class='fu'>map</span><span class='op'>(</span>.f <span class='op'>=</span> <span class='va'>pull</span>, var <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># passando o vetor de strings para um unico string por elemento da lista</span>
  <span class='fu'>map</span><span class='op'>(</span>.f <span class='op'>=</span> <span class='va'>paste0</span>, collapse <span class='op'>=</span> <span class='st'>';'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># juntando os elementos da lista coluna a coluna</span>
  <span class='fu'>bind_cols</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># visualizando a tabela</span>
  <span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mecanicas"],"name":[1],"type":["chr"],"align":["left"]},{"label":["categorias"],"name":[2],"type":["chr"],"align":["left"]},{"label":["temas"],"name":[3],"type":["chr"],"align":["left"]},{"label":["artistas"],"name":[4],"type":["chr"],"align":["left"]},{"label":["designers"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Gestão de Mão;Construção de Rotas;Seleção de Cartas","2":"Jogo de Entrada","3":"Transportes","4":"Julien Delval;Cyrille Daujean","5":"Alan R. Moon"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<p>Como estes dois passos são baseados no mesmo dado e devem compor o mesmo parser, vamos empacotá-los em uma única função, <code>parser_infos_jogos</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># função para parsear as informações de um jogo</span>
<span class='va'>parser_infos_jogo</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>target_path</span><span class='op'>)</span><span class='op'>{</span>
  <span class='co'># carregando o arquivo JSON com os metadados do jogo</span>
  <span class='va'>metadados</span> <span class='op'>&lt;-</span> <span class='fu'>jsonlite</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/jsonlite/man/read_json.html'>read_json</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>target_path</span>, simplifyDataFrame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='co'># colocando todos os metadados em um tibble</span>
  <span class='fu'>bind_cols</span><span class='op'>(</span>
    <span class='co'># parseando as informacoes que estao organizadas como strings ou numeros</span>
    <span class='va'>metadados</span> <span class='op'>%&gt;%</span> 
      <span class='co'># descartando todos os elementos que sao dataframes</span>
      <span class='fu'>discard</span><span class='op'>(</span><span class='va'>is.data.frame</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='co'># juntando cada elemento da lista coluna a coluna</span>
      <span class='fu'>bind_cols</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='co'># parseando as informacoes que estao organizadas como uma lista de dataframes</span>
    <span class='va'>metadados</span> <span class='op'>%&gt;%</span> 
      <span class='co'># retendo apenas os elementos que sao dataframes</span>
      <span class='fu'>keep</span><span class='op'>(</span><span class='va'>is.data.frame</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='co'># pegando a coluna que contem os o nome do metadado</span>
      <span class='fu'>map</span><span class='op'>(</span>.f <span class='op'>=</span> <span class='va'>pull</span>, var <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='co'># passando o vetor de strings para um unico string por elemento da lista</span>
      <span class='fu'>map</span><span class='op'>(</span>.f <span class='op'>=</span> <span class='va'>paste0</span>, collapse <span class='op'>=</span> <span class='st'>';'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='co'># juntando os elementos da lista coluna a coluna</span>
      <span class='fu'>bind_cols</span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## usando a função para parsear todas as informações</span>
<span class='fu'>parser_infos_jogo</span><span class='op'>(</span>target_path <span class='op'>=</span> <span class='fu'>dir_ls</span><span class='op'>(</span><span class='va'>path_para_metadata</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># visualizando a tabela completa</span>
  <span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id_jogo"],"name":[1],"type":["int"],"align":["right"]},{"label":["nm_jogo"],"name":[2],"type":["chr"],"align":["left"]},{"label":["thumb"],"name":[3],"type":["chr"],"align":["left"]},{"label":["tp_jogo"],"name":[4],"type":["chr"],"align":["left"]},{"label":["link"],"name":[5],"type":["chr"],"align":["left"]},{"label":["ano_publicacao"],"name":[6],"type":["int"],"align":["right"]},{"label":["ano_nacional"],"name":[7],"type":["int"],"align":["right"]},{"label":["qt_jogadores_min"],"name":[8],"type":["int"],"align":["right"]},{"label":["qt_jogadores_max"],"name":[9],"type":["int"],"align":["right"]},{"label":["vl_tempo_jogo"],"name":[10],"type":["int"],"align":["right"]},{"label":["idade_minima"],"name":[11],"type":["int"],"align":["right"]},{"label":["qt_tem"],"name":[12],"type":["int"],"align":["right"]},{"label":["qt_teve"],"name":[13],"type":["int"],"align":["right"]},{"label":["qt_favorito"],"name":[14],"type":["int"],"align":["right"]},{"label":["qt_quer"],"name":[15],"type":["int"],"align":["right"]},{"label":["qt_jogou"],"name":[16],"type":["int"],"align":["right"]},{"label":["mecanicas"],"name":[17],"type":["chr"],"align":["left"]},{"label":["categorias"],"name":[18],"type":["chr"],"align":["left"]},{"label":["temas"],"name":[19],"type":["chr"],"align":["left"]},{"label":["artistas"],"name":[20],"type":["chr"],"align":["left"]},{"label":["designers"],"name":[21],"type":["chr"],"align":["left"]}],"data":[{"1":"2","2":"Ticket to Ride","3":"https://storage.googleapis.com/ludopedia-capas/2_t.jpg","4":"b","5":"https://www.ludopedia.com.br/jogo/ticket-to-ride","6":"2004","7":"2014","8":"2","9":"5","10":"45","11":"8","12":"3149","13":"382","14":"443","15":"1831","16":"3914","17":"Gestão de Mão;Construção de Rotas;Seleção de Cartas","18":"Jogo de Entrada","19":"Transportes","20":"Julien Delval;Cyrille Daujean","21":"Alan R. Moon"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<p>Pronto! Com isso podemos ter acesso às informações que caracterizam cada um dos jogos de tabuleiro cadastrados no portal da Ludopedia.</p>
<h2 id="outros-usos-da-api">Outros usos da API</h2>
<p>No momento em que escrevo este post, a API da Ludopedia ainda está em fase de desenvolvimento e, portanto, existem algumas funcionalidades que estão previstas mas ainda não foram implementadas. De toda forma, no estado atual dela também podemos ter acesso à uma informação muito interessante: à coleção de jogos de tabuleiro de cada usuário. Este dado é legal pois ele traz coisas como as notas que a pessoa usuária deu à cada jogo, os comentários que a pessoa usuária fez sobre ele, se a pessoa tem ou não aquele jogo e coisas do gênero. Assim, ainda que a API não esteja completa, ela tem muitos outros potenciais de uso para a análise de dados.</p>
<p>Um exemplo de uso daqueles dados poderia ser na criação de algum tipo de sistema de recomendação, uma vez que podemos mapear as notas dadas à cada jogo de tabuleiro por cada um dos usuários. Não é o meu intuito detalhar aqui como usar a API para extrair este tipo de informação, mas podemos ter uma visão bem alto nível através da documentação da API: usamos um <em>endpoint</em> para extrair a coleção de jogos de uma pessoa usuária qualquer através do seu identificador (<em>i.e.</em>, <code>https://ludopedia.com.br/api/v1/colecao</code>); este identificador, por sua vez, pode ser extraído a partir de um outro <em>endpoint</em>, que traz a lista de usuários cadastrados no portal (<em>i.e.</em>, <code>https://ludopedia.com.br/api/v1/usuarios</code>); por fim, temos acesso a um máximo de 100 jogos por vez da coleção de cada pessoa, e precisaremos usar o mesmo método para a paginação das <em>querys</em> para extrair a coleção completa de cada usuário - e é possível determinar o tamanho da coleção de cada usuário diretamente através de um outro <em>endpoint</em> (<em>i.e.</em>, <code>https://ludopedia.com.br/api/v1/colecao/count</code>). É claro que precisaremos aplicar algum tratamento aos dados que a API nos retorna para chegar à estrutura necessária para um sistema de recomendação, mas acredito que dê para pegar a ideia geral aqui.</p>
<h1 id="dicionário-de-dados">Dicionário de Dados</h1>
<p>Como a ideia é utilizar os dados dessa API no futuro, vou deixar aqui um dicionário para explicar as informações dos metadados que temos disponíveis - de forma similar ao que fiz para a API do BoardGameGeek.</p>
<ul>
<li><strong>id_jogo:</strong> identificador numérico único do jogo;<br />
</li>
<li><strong>nm_jogo:</strong> nome do jogo em português;<br />
</li>
<li><strong>thumb:</strong> link para a imagem de capa do jogo;<br />
</li>
<li><strong>tp_jogo:</strong> indicador do tipo de jogo - jogo base (b) ou expansão (e);<br />
</li>
<li><strong>link:</strong> link para a página do jogo dentro do domínio da Ludopedia;<br />
</li>
<li><strong>ano_publicacao:</strong> ano de criação do jogo;<br />
</li>
<li><strong>ano_nacional:</strong> ano de lançamento do jogo no Brasil - é <code>NA</code> caso o jogo não tenha sido lançado por aqui;<br />
</li>
<li><strong>qt_jogadores_min:</strong> quantidade mínima de jogadores necessária para o jogo;<br />
</li>
<li><strong>qt_jogadores_max:</strong> quantidade máxima de jogadores sustentada pelo jogo;<br />
</li>
<li><strong>vl_tempo_jogo:</strong> duração de uma partida do jogo;<br />
</li>
<li><strong>idade_minima:</strong> idade mínima sugerida para o jogo;<br />
</li>
<li><strong>qt_tem:</strong> quantidade de usuários que têm o jogo;</li>
<li><strong>qt_teve:</strong> quantidade de usuários que já tiveram o jogo;</li>
<li><strong>qt_favorito:</strong> quantidade de usuários que têm este jogo como favorito;<br />
</li>
<li><strong>qt_quer:</strong> quantidade de usuários que estão em busca do jogo;<br />
</li>
<li><strong>qt_jogou:</strong> quantidade de usuários que jogou o jogo;<br />
</li>
<li><strong>mecanicas:</strong> nomes da mecânicas de jogo;<br />
</li>
<li><strong>categorias:</strong> nome das famílias associadas ao jogo;<br />
</li>
<li><strong>temas:</strong> nomes das temáticas associadas ao jogo;<br />
</li>
<li><strong>designers:</strong> nome das pessoas do autoras do jogo;<br />
</li>
<li><strong>artistas:</strong> nome das pessoas artistas responsáveis pela arte jogo.</li>
</ul>
<h1 id="conclusões">Conclusões</h1>
<p>Este post focou em demonstrar como interagir com a API da Ludopedia, indo do processo de autenticação, à requisição e o parser dos dados. Focamos exclusivamente nos <em>endpoints</em> para a aquisição dos dados dos jogos de tabuleiro, mas o mesmo processo pode ser utilizado para a aquisição de outros tipos de dados, tais como a lista lista de usuários, suas coleções e informações das partidas. Como vimos através deste exercício, essa API fornece uma forma bastante amigável de acessarmos dados muito relevantes para muitos tipos de análise.</p>
<p>Esta API é bastante diferente daquela oferecidade pelo BoardGameGeek, não só em termos de uso, mas também dos dados fornecidos. Neste contexto, pude notar que os metadados dos jogos de tabuleiro oferecidos pela API da Ludopedia representam um subconjunto daqueles disponíveis na página de cada jogo dentro do próprio portal, assim como daqueles que estão disponíveis através da API do BoardGameGeek. Comparando as informações àquelas no próprio portal, por exemplo, a API da Ludopedia não traz nada sobre as editoras, domínios e nem dependência do idioma. Nesta mesma linha, a API do BoardGameGeek fornece as informações das notas dos jogos junto dos metadados, ao contrário desta API que exploramos. Assim, me parece que ainda há espaço para que ela possa evoluir.</p>
<p>Por fim, o fato da API não fornecer tantas informações como àquelas do BoardGameGeek não é um problema. O principal motivo para isso é que é possível integrar as duas fontes de informação, usando uma para enriquecer a outra - como veremos através das análises de dados que faremos em posts futuros.</p>
<h1 id="possíveis-extensões">Possíveis Extensões</h1>
<p>Acredito que grande parte das extensões que listei no post sobre a <a href="https://nacmarino.github.io/codex/posts/2022-01-23-interagindo-com-a-api-do-boardgamegeek/">API do BoardGameGeek</a> valha para este também - além, é claro, do fato de que várias destas extensões são co-dependentes entre os dois posts. De toda forma, acredito que a principal extensão relacionada especificamente a este post seria a da implementação das funções para acessar os dados de outros <em>endpoints</em>, juntamente com os seus respectivos parsers.</p>
<p>Dúvidas, sugestões ou críticas? É só me procurar pelo e-mail ou GitHub!</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
